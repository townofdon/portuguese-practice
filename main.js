/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/resources/conjugation-ver-vir.yaml":
/*!************************************************!*\
  !*** ./src/resources/conjugation-ver-vir.yaml ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({ver:{present:[{pr:'eu vejo o sol todos os dias',en:'I see the sun every day'},{pr:'ele vê os pássaros voando',en:'he sees the birds flying'},{pr:'nós vemos o mar daqui',en:'we see the sea from here'},{pr:'eles veem os animais na floresta',en:'the see the animals in the forest'}],imperfect:[{pr:'eu via os carros passarem na rua',en:'I used to see the cars passing in the road'},{pr:'ele via os animais na floresta',en:'he used to see the animals in the forest'},{pr:'nós víamos o pôr do sol na praia',en:'we used to see the sunset on the beach'},{pr:'eles viam a lua no céu',en:'they used to see the moon in the sky'}],preterite:[{pr:'eu vi o filme ontem',en:'I saw the film yesterday'},{pr:'ele viu o trem passar',en:'he saw the train pass'},{pr:'nós vimos o mar agitado',en:'we saw the rough sea'},{pr:'eles viram o eclipse da lua',en:'they saw the eclipse of the moon'}],presentPerfect:[{pr:'eu tenho visto muitos filmes bons',en:'I have seen many good films'},{pr:'ele tem visto muitas estrelas à noite',en:'he has seen many stars at night'},{pr:'nós temos visto o pôr do sol juntos',en:'we have seen the sunset together'},{pr:'eles têm visto os fogos de artifício no céu',en:'they have seen the fireworks in the sky'}],future:[{pr:'eu verei o nascer do sol amanhã',en:'I will see the sunrise tomorrow'},{pr:'ele verá os fogos de artifício no reveillon',en:'He will see the fireworks on New Year\'s Eve'},{pr:'nós veremos o mar azul na viagem',en:'we will see the blue sea on the journey'},{pr:'eles verão as flores no jardim',en:'they will see the flowers in the garden'}]},vir:{present:[{pr:'eu venho sempre ao parque',en:'I always come to the park'},{pr:'eu tenho satisfação quando eu venho aqui',en:'I have satisfaction when I come here'},{pr:'ela vem mais tarde',en:'she comes later'},{pr:'nós vimos o filme juntos',en:'we see the film together'},{pr:'eles vêm de longe',en:'they come from afar'}],imperfect:[{pr:'eu vinha ao parque todos os dias',en:'I used to come to the park every day'},{pr:'ele vinha ler aqui à tarde',en:'he used to come read here in the afternoon'},{pr:'nós vinhamos sempre antes do jantar',en:'we used to always come before dinner'},{pr:'eles vinham jogar futebol todas as tardes',en:'they used to come play soccer every afternoon'}],preterite:[{pr:'eu vim à praia hoje',en:'I came to the beach today'},{pr:'ele veio ajudar a avó',en:'he came to help his grandmother'},{pr:'nós viemos almoçar contigo',en:'we came to have lunch with you'},{pr:'eles vieram rápido demais',en:'they came too fast'}],presentPerfect:[{pr:'eu tehno vindo aqui com frequência',en:'I have been coming here often'},{pr:'ele tem vindo ajudar os outros',en:'he has been coming to help others'},{pr:'nós temos vindo passear no parque',en:'we have been coming for a walk in the park'},{pr:'eles têm vindo brincar no parque',en:'they have been coming to play in the park'}],future:[{pr:'eu virei buscar você mais tarde',en:'I will come find you later'},{pr:'ele virá ajudar na festa',en:'he will come help at the party'},{pr:'nós viremos jantar juntos',en:'we will come to dinner together'},{pr:'eles virão no próximo final de semana',en:'they will come next weekend'}]}});

/***/ }),

/***/ "./src/resources/weak-phrases.yaml":
/*!*****************************************!*\
  !*** ./src/resources/weak-phrases.yaml ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ([{pr:'Ele é um colecionador que coleciona itens',en:'He is a collector who collects items'},{pr:'Tenho uma coleção',en:'I have a collection'},{pr:'Vou **ganhar** mais dinheiro naquela hora',en:'I will **get** more money at that time'},{pr:'Foi escuro lá fora',en:'It was dark outside'},{pr:'Está ficando oscuro lá fora',en:'It is getting dark outside'},{pr:'Venha me conhecer algum dia',en:'Come and meet me some day'},{pr:'Venha me ver algum dia',en:'Come and see me some day'},{pr:'Não perca a fé',en:'Do not lose faith'},{pr:'Ele não perde a fé',en:'He does not lose faith'},{pr:'Ela me apresentou ao seu namorado na festa',en:'She introduced me to her boyfriend at the party'},{pr:'Ele levou meu casaco',en:'He took my coat'},{pr:'Eu te dou este relógio como um presente',en:'I give this watch to you as a gift'},{pr:'Eu sonhei um sonho de um tempo passado',en:'I dreamed a dream of time gone by'},{pr:'Eu me diverti muito',en:'I had a good time'},{pr:'Foi um bom momento',en:'It was a good time'},{pr:'Ele veio de longe',en:'He came from far away'},{pr:'Estou vindo',en:'I am coming'},{pr:'Continue em frente, por favor',en:'Keep going forward, please'},{pr:'A luz é brilhante',en:'The light is bright'},{pr:'É favorável para nós irmos',en:'It is favorable for us to go'},{pr:'Eu pensei que nosso **compromisso** seria na semana que vem',en:'I thought that our **meeting** was next week'},{pr:'Isso não quer dizer nada',en:'This doesn\'t mean anything'},{pr:'Eles me **dão** arroz',en:'They **give** me rice'},{pr:'Ele não deve vir aqui novamente',en:'He must not come here again'},{pr:'Há outros fatores que nos fazem pensar assim',en:'There are other factors that make us think like that'},{pr:'Ela nos explora',en:'She exploits us'},{pr:'O restaurante fica em frente à escola',en:'The restaurant is in front of the school'},{pr:'Este é meu tipo de personagem',en:'This is my type of character'},{pr:'Eu não vejo minha namorada há duas semanas',en:'I have not seen my girlfriend for two weeks'},{pr:'Como tem passado o seu pai?',en:'How has your father been?'},{pr:'Meu filho tem me perguntado **coisas estranhas**',en:'My son has been asking me **strange questions**'},{pr:'Tente descobrir se tudo que ele disse é verdade',en:'Try to find out if everything that he said is true'},{pr:'Ele me conta tudo',en:'He tells me everything'},{pr:'Eu segurei um bebé em meus braços',en:'I held a baby in my arms'}]);

/***/ }),

/***/ "./src/Logger.js":
/*!***********************!*\
  !*** ./src/Logger.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Logger: () => (/* binding */ Logger)
/* harmony export */ });

const Logger = {
  _enabled: false,
  _debug: false,

  enable() {
    Logger._enabled = true;
  },

  disable() {
    Logger._enabled = false;
  },

  enableDebug() {
    Logger._debug = true;
  },

  disableDebug() {
    Logger._debug = false;
  },

  debug(...args) {
    if (!Logger._enabled) {
      return;
    }
    if (!Logger._debug) {
      return;
    }
    console.log(...args);
  },

  info(...args) {
    if (!Logger._enabled) {
      return;
    }
    console.log(...args);
  },

  warn(...args) {
    if (!Logger._enabled) {
      return;
    }
    console.warn(...args);
  },

  error(...args) {
    // always show errors
    console.error(...args);
  },
}


/***/ }),

/***/ "./src/app.js":
/*!********************!*\
  !*** ./src/app.js ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resources/conjugation-ver-vir.yaml */ "./src/resources/conjugation-ver-vir.yaml");
/* harmony import */ var _resources_weak_phrases_yaml__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resources/weak-phrases.yaml */ "./src/resources/weak-phrases.yaml");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants */ "./src/constants.js");
/* harmony import */ var _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./keyboardUtils */ "./src/keyboardUtils.js");
/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Logger */ "./src/Logger.js");
/* harmony import */ var _speak__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./speak */ "./src/speak.js");
/* harmony import */ var _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./stores/OptionsStore */ "./src/stores/OptionsStore.js");
/* harmony import */ var _stores_QuestionsStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./stores/QuestionsStore */ "./src/stores/QuestionsStore.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils */ "./src/utils.js");











_Logger__WEBPACK_IMPORTED_MODULE_4__.Logger.enable();
_Logger__WEBPACK_IMPORTED_MODULE_4__.Logger.disableDebug();

const cardQuestion = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('card-question');
const cardAnswer = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('card-answer');
const cardQuestionContent = cardQuestion.children[0]
const cardAnswerContent = cardAnswer.children[0]

;(0,_utils__WEBPACK_IMPORTED_MODULE_8__.assert)(cardQuestionContent, 'cardQuestionContent does not exist');
(0,_utils__WEBPACK_IMPORTED_MODULE_8__.assert)(cardAnswerContent, 'cardAnswerContent does not exist');

const buttonPrev = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-prev');
const buttonNext = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-next');
const buttonReshuffle = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-reshuffle');
const buttonSpeak = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-speak');
const buttonSnooze1h = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-snooze-1h');
const buttonSnooze7d = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-snooze-7d');
const buttonSnooze30d = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('button-snooze-30d');
const progress = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('progress');
const formQuestionOrder = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('form-question-order');
const formSelectExercises = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.requireById)('form-select-exercises');

const state = {
  revealed: false,
  problems: [], // array of tuples -> [question, answer, portuguese-index-for-text-to-speech][]
  index: 0,
  order: _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_6__.optionsStore.getOrder(),
  selectedExercises: _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_6__.optionsStore.getSelectedExercises(),
};

function main() {
  renderOptions();
  shuffleQuestions();
  setupListeners();
}

function randBool() {
  return Math.random() >= 0.5
}

function shuffleQuestions() {
  state.revealed = false;
  state.problems = [];
  state.index = 0;
  const problems = []
  const addProblem = (problem) => {
    if (!problem.en || !problem.pr) {
      throw new Error(`Problem is invalid: ${JSON.stringify(problem)}`)
    }
    if (state.order === _constants__WEBPACK_IMPORTED_MODULE_2__.ORDER.EN_FIRST) {
      problems.push([problem.en, problem.pr, 1]);
    } else if (state.order === _constants__WEBPACK_IMPORTED_MODULE_2__.ORDER.PR_FIRST) {
      problems.push([problem.pr, problem.en, 0]);
    } else {
      const flip = randBool();
      if (flip) {
        problems.push([problem.en, problem.pr, 1]);
      } else {
        problems.push([problem.pr, problem.en, 0]);
      }
    }
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.VER_CONJATION]) {
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.present.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.preterite.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.imperfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.presentPerfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.future.forEach(addProblem);
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.VIR_CONJUGATION]) {
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.present.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.preterite.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.imperfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.presentPerfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.future.forEach(addProblem);
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.WEAK_PHRASES]) {
    _resources_weak_phrases_yaml__WEBPACK_IMPORTED_MODULE_1__["default"].forEach(addProblem);
  }

  state.problems = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.shuffleArray)(problems);

  prepareHashData(() => {
    renderContent();
  });
}

function playTranslationAudio() {
  const numProblems = state.problems.length

  if (numProblems === 0) {
    return;
  }

  const currentIndex = state.index % numProblems;
  const currentProblem = state.problems[currentIndex];
  (0,_speak__WEBPACK_IMPORTED_MODULE_5__.speak)(currentProblem[currentProblem[2]])
}

function advance() {
  if (state.revealed) {
    state.index++;
    state.revealed = false;
  } else {
    state.revealed = true;
  }
  renderContent();
}

function rewind() {
  state.revealed = false;
  state.index--;
  if (state.index < 0) state.index = state.problems.length - 1;
  renderContent();
}

function setupListeners() {
  buttonNext.addEventListener('click', advance);
  buttonPrev.addEventListener('click', rewind);
  buttonReshuffle.addEventListener('click', shuffleQuestions);
  buttonSpeak.addEventListener('click', playTranslationAudio);
  buttonSnooze1h.addEventListener('click', handleClickSnooze);
  buttonSnooze7d.addEventListener('click', handleClickSnooze);
  buttonSnooze30d.addEventListener('click', handleClickSnooze);
  document.addEventListener('keydown', handleKeyPress);
  formQuestionOrder.addEventListener('change', handleQuestionOrderChange)
  formSelectExercises.addEventListener('change', handleSelectExerciseCheck)
}

/**
 * @param {KeyboardEvent} ev
 */
function handleKeyPress(ev) {
  if (!ev) return;

  if ((0,_keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.isCharPressed)(ev, _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.SpecialKey.ArrowRight)) {
    advance();
  } else if ((0,_keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.isCharPressed)(ev, _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.SpecialKey.ArrowLeft)) {
    rewind();
  } else if ((0,_keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.isCharPressed)(ev, _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.SpecialKey.Space)) {
    ev.preventDefault();
    playTranslationAudio();
  }
}

/**
 * @param {KeyboardEvent} ev
 */
function handleQuestionOrderChange(ev) {
  state.order = ev.target.value;
  _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_6__.optionsStore.setOrder(ev.target.value);
  shuffleQuestions();
}

/**
 * @param {KeyboardEvent} ev
 */
function handleSelectExerciseCheck(ev) {
  state.selectedExercises[ev.target.name] = ev.target.checked;
  _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_6__.optionsStore.setSelectedExercise(ev.target.name, ev.target.checked);
  shuffleQuestions();
}

function handleClickSnooze(ev) {
  const seconds = parseInt(ev.currentTarget.dataset.seconds, 10) || 0;
  if (!seconds) return;
  const snoozeDurationMs = seconds * 1000;
  snoozeCurrentQuestion(snoozeDurationMs);
}

function renderContent() {
  const numProblems = state.problems.length

  if (numProblems === 0) {
    cardQuestionContent.innerHTML = "Please select an exercise to begin";
    cardAnswerContent.innerHTML = "Por favor selecione um exercício para começar";
    cardAnswer.classList.add('revealed');
    progress.innerHTML = "0 / 0";
    return;
  }

  const currentIndex = state.index % numProblems;
  const progressText = `${currentIndex + 1} / ${numProblems}`
  const currentProblem = state.problems[currentIndex];

  (0,_utils__WEBPACK_IMPORTED_MODULE_8__.assert)(currentProblem, `currentProblem out of bounds - tried index ${currentIndex} for array of length ${numProblems}`);

  cardQuestionContent.innerHTML = markifyText(currentProblem[0]);
  cardAnswerContent.innerHTML = markifyText(currentProblem[1]);

  if (state.revealed) {
    cardAnswer.classList.add('revealed');
  } else {
    cardAnswer.classList.remove('revealed');
  }

  progress.innerHTML = progressText;
}

function renderOptions() {
  formQuestionOrder.querySelectorAll('input').forEach(input => {
    if (input.name === 'question-order') {
      input.checked = state.order === input.value;
    }
  });

  formSelectExercises.querySelectorAll('input').forEach(input => {
    if (input.name.includes('checkbox-exercise')) {
      input.checked = state.selectedExercises[input.name];
    }
  });
}

/**
 * @param {string} text
 * @returns string
 */
function markifyText(text) {
  const regMarkdownBoldStart = /(?<!\S)\*\*(?!\s)/g;
  const regMarkdownBoldEnd = /(?<!\s)\*\*(?!\S)/g;
  return text
    .replace(regMarkdownBoldStart, "<strong class=\"accent\">")
    .replace(regMarkdownBoldEnd, "</strong>")
}

function snoozeCurrentQuestion(snoozeDurationMs) {
  const numProblems = state.problems.length
  if (numProblems === 0) {
    return;
  }
  const currentIndex = state.index % numProblems;
  const currentProblem = state.problems[currentIndex];
  const hash = currentProblem[3];
  if (_stores_QuestionsStore__WEBPACK_IMPORTED_MODULE_7__.questionsStore.snoozeQuestion(hash, snoozeDurationMs)) {
    state.problems = (0,_utils__WEBPACK_IMPORTED_MODULE_8__.removeArrayElement)(state.problems, currentIndex);
    state.revealed = false;
    renderContent();
  }
}

let cleanupHashProcessor = null;

/**
 * Hash Portuguese phrase to allow for "snoozing" a flash card
 */
function prepareHashData(onProcessingComplete = () => {}) {
  if (cleanupHashProcessor) {
    cleanupHashProcessor();
  }

  let ignore = false;

  async function process() {
    const timeStart = performance.now();
    let i = 0;
    while (!ignore && i < state.problems.length) {
      const problem = state.problems[i];
      const ptPhrase = problem[problem[2]];
      const hash = await (0,_utils__WEBPACK_IMPORTED_MODULE_8__.sha256)(ptPhrase);
      state.problems[i][3] = hash;
      _Logger__WEBPACK_IMPORTED_MODULE_4__.Logger.debug(`processing msg ${i} - ${hash} generated for "${ptPhrase}"`)
      i++;
    }
    if (!ignore) {
      const snoozedQuestions = _stores_QuestionsStore__WEBPACK_IMPORTED_MODULE_7__.questionsStore.getSnoozedQuestions();
      state.problems = state.problems.filter(problem => {
        const hash = problem[3];
        const currentTime = Date.now();
        const timeSnoozeExpiresMs = snoozedQuestions[hash] || 0;
        return !!hash && timeSnoozeExpiresMs < currentTime
      })

      const timeEnd = performance.now();
      _Logger__WEBPACK_IMPORTED_MODULE_4__.Logger.info(`processing complete! - took ${timeEnd - timeStart}ms`);
      onProcessingComplete();
    }
  }

  process();

  cleanupHashProcessor = () => {
    ignore = true;
    cleanupHashProcessor = null;
  }
}

main();


/***/ }),

/***/ "./src/constants.js":
/*!**************************!*\
  !*** ./src/constants.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EXERCISE: () => (/* binding */ EXERCISE),
/* harmony export */   ORDER: () => (/* binding */ ORDER)
/* harmony export */ });

const ORDER = {
  PR_FIRST: 'pr-first',
  EN_FIRST: 'en-first',
  ANY: 'any',
}

const EXERCISE = {
  VER_CONJATION: 'checkbox-exercise-ver-conjugation',
  VIR_CONJUGATION: 'checkbox-exercise-vir-conjugation',
  WEAK_PHRASES: 'checkbox-exercise-weak-phrases',
}


/***/ }),

/***/ "./src/keyboardUtils.js":
/*!******************************!*\
  !*** ./src/keyboardUtils.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SpecialKey: () => (/* binding */ SpecialKey),
/* harmony export */   findNumberPressed: () => (/* binding */ findNumberPressed),
/* harmony export */   isCharPressed: () => (/* binding */ isCharPressed),
/* harmony export */   isNumberPressed: () => (/* binding */ isNumberPressed)
/* harmony export */ });

const SpecialKey = {
  Backspace: 'backspace',
  Escape: 'escape',
  Tab: 'tab',
  Space: 'space',
  Enter: 'enter',
  Delete: 'delete',
  ArrowUp: 'ArrowUp',
  ArrowDown: 'ArrowDown',
  ArrowLeft: 'ArrowLeft',
  ArrowRight: 'ArrowRight',
}

/**
 * Keyboard options
 * @typedef {Object} KeyboardOptions
 * @property {boolean} [ctrlKey] - control key is pressed.
 * @property {boolean} [shiftKey] - shift key is pressed.
 * @property {boolean} [altKey] - alt key is pressed.
 */

/**
 * determine whether a number is pressed
 * @param {KeyboardEvent} ev 
 * @param {number} num 
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function isNumberPressed(ev, num, opts = {}) {
  if (!areOptionsSatisfied(ev, opts)) return false;
  return findNumberPressed(ev) === num;
}

/**
 * determine whether a char is pressed
 * @param {KeyboardEvent} ev 
 * @param {string} char
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function isCharPressed(ev, char, opts = {}) {
  if (!areOptionsSatisfied(ev, opts)) return false;
  return findCharPressed(ev) === char;
}

/**
 * Determine whether options are satisfied (ctrl, alt, shift, etc.)
 * @param {KeyboardEvent} ev 
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function areOptionsSatisfied(ev, opts = {}) {
  if (!ev) return false;
  const isControlPressed = ev.metaKey || ev.ctrlKey; // meta key is CMD key on mac
  const isShiftPressed = ev.shiftKey;
  const isAltKeyPressed = ev.altKey;
  if (opts.ctrlKey && !isControlPressed) return false;
  if (opts.shiftKey && !isShiftPressed) return false;
  if (opts.altKey && !isAltKeyPressed) return false;
  return true;
}

/**
 * Find number pressed, or -1 if no match found
 * @param {KeyboardEvent} ev
 * @returns number
 */
function findNumberPressed(ev) {
  if (ev.key === '0' || ev.code === 'Digit0' || ev.code === 'Numpad0' || ev.keyCode === 48 || ev.keyCode === 96) return 0;
  if (ev.key === '1' || ev.code === 'Digit1' || ev.code === 'Numpad1' || ev.keyCode === 49 || ev.keyCode === 97) return 1;
  if (ev.key === '2' || ev.code === 'Digit2' || ev.code === 'Numpad2' || ev.keyCode === 50 || ev.keyCode === 98) return 2;
  if (ev.key === '3' || ev.code === 'Digit3' || ev.code === 'Numpad3' || ev.keyCode === 51 || ev.keyCode === 99) return 3;
  if (ev.key === '4' || ev.code === 'Digit4' || ev.code === 'Numpad4' || ev.keyCode === 52 || ev.keyCode === 100) return 4;
  if (ev.key === '5' || ev.code === 'Digit5' || ev.code === 'Numpad5' || ev.keyCode === 53 || ev.keyCode === 101) return 5;
  if (ev.key === '6' || ev.code === 'Digit6' || ev.code === 'Numpad6' || ev.keyCode === 54 || ev.keyCode === 102) return 6;
  if (ev.key === '7' || ev.code === 'Digit7' || ev.code === 'Numpad7' || ev.keyCode === 55 || ev.keyCode === 103) return 7;
  if (ev.key === '8' || ev.code === 'Digit8' || ev.code === 'Numpad8' || ev.keyCode === 56 || ev.keyCode === 104) return 8;
  if (ev.key === '9' || ev.code === 'Digit9' || ev.code === 'Numpad9' || ev.keyCode === 57 || ev.keyCode === 105) return 9;
  return -1;
}

/**
 * Find char pressed, or "" if no match found
 * @param {KeyboardEvent} ev
 * @returns string
 */
function findCharPressed(ev) {
  const num = findNumberPressed(ev);
  if (num !== -1) return String(num);
  if (ev.key === 'a' || ev.code === 'KeyA' || ev.keyCode === 65) return 'a';
  if (ev.key === 'b' || ev.code === 'KeyB' || ev.keyCode === 66) return 'b';
  if (ev.key === 'c' || ev.code === 'KeyC' || ev.keyCode === 67) return 'c';
  if (ev.key === 'd' || ev.code === 'KeyD' || ev.keyCode === 68) return 'd';
  if (ev.key === 'e' || ev.code === 'KeyE' || ev.keyCode === 69) return 'e';
  if (ev.key === 'f' || ev.code === 'KeyF' || ev.keyCode === 70) return 'f';
  if (ev.key === 'g' || ev.code === 'KeyG' || ev.keyCode === 71) return 'g';
  if (ev.key === 'h' || ev.code === 'KeyH' || ev.keyCode === 72) return 'h';
  if (ev.key === 'i' || ev.code === 'KeyI' || ev.keyCode === 73) return 'i';
  if (ev.key === 'j' || ev.code === 'KeyJ' || ev.keyCode === 74) return 'j';
  if (ev.key === 'k' || ev.code === 'KeyK' || ev.keyCode === 75) return 'k';
  if (ev.key === 'l' || ev.code === 'KeyL' || ev.keyCode === 76) return 'l';
  if (ev.key === 'm' || ev.code === 'KeyM' || ev.keyCode === 77) return 'm';
  if (ev.key === 'n' || ev.code === 'KeyN' || ev.keyCode === 78) return 'n';
  if (ev.key === 'o' || ev.code === 'KeyO' || ev.keyCode === 79) return 'o';
  if (ev.key === 'p' || ev.code === 'KeyP' || ev.keyCode === 80) return 'p';
  if (ev.key === 'q' || ev.code === 'KeyQ' || ev.keyCode === 81) return 'q';
  if (ev.key === 'r' || ev.code === 'KeyR' || ev.keyCode === 82) return 'r';
  if (ev.key === 's' || ev.code === 'KeyS' || ev.keyCode === 83) return 's';
  if (ev.key === 't' || ev.code === 'KeyT' || ev.keyCode === 84) return 't';
  if (ev.key === 'u' || ev.code === 'KeyU' || ev.keyCode === 85) return 'u';
  if (ev.key === 'v' || ev.code === 'KeyV' || ev.keyCode === 86) return 'v';
  if (ev.key === 'w' || ev.code === 'KeyW' || ev.keyCode === 87) return 'w';
  if (ev.key === 'x' || ev.code === 'KeyX' || ev.keyCode === 88) return 'x';
  if (ev.key === 'y' || ev.code === 'KeyY' || ev.keyCode === 89) return 'y';
  if (ev.key === 'z' || ev.code === 'KeyZ' || ev.keyCode === 90) return 'z';
  if (ev.key === '`' || ev.code === 'Backquote' || ev.keyCode === 192) return '`';
  if (ev.key === '-' || ev.code === 'Minus' || ev.keyCode === 189) return '-';
  if (ev.key === '=' || ev.code === 'Equals' || ev.keyCode === 187) return '=';
  if (ev.key === '-' || ev.code === 'NumpadSubtract' || ev.keyCode === 109) return '-';
  if (ev.key === '+' || ev.code === 'NumpadAdd' || ev.keyCode === 107) return '+';
  if (ev.key === '[' || ev.code === 'BracketLeft' || ev.keyCode === 219) return '[';
  if (ev.key === ']' || ev.code === 'BracketRight' || ev.keyCode === 221) return ']';
  if (ev.key === 'Backspace' || ev.code === 'Backspace' || ev.keyCode === 221) return SpecialKey.Backspace;
  if (ev.key === 'Escape' || ev.code === 'Escape' || ev.keyCode === 27) return SpecialKey.Escape;
  if (ev.key === ' ' || ev.code === 'Space' || ev.keyCode === 32) return SpecialKey.Space;
  if (ev.key === 'Enter' || ev.code === 'Enter' || ev.code === 'NumpadEnter' || ev.keyCode === 13) return SpecialKey.Enter;
  if (ev.key === 'Delete' || ev.code === 'Delete' || ev.keyCode === 46) return SpecialKey.Delete;
  if (ev.key === 'ArrowUp' || ev.code === 'ArrowUp' || ev.keyCode === 38) return SpecialKey.ArrowUp;
  if (ev.key === 'ArrowDown' || ev.code === 'ArrowDown' || ev.keyCode === 40) return SpecialKey.ArrowDown;
  if (ev.key === 'ArrowLeft' || ev.code === 'ArrowLeft' || ev.keyCode === 37) return SpecialKey.ArrowLeft;
  if (ev.key === 'ArrowRight' || ev.code === 'ArrowRight' || ev.keyCode === 39) return SpecialKey.ArrowRight;
  return ''
}


/***/ }),

/***/ "./src/speak.js":
/*!**********************!*\
  !*** ./src/speak.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   speak: () => (/* binding */ speak)
/* harmony export */ });
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "./src/utils.js");


const synth = window.speechSynthesis;

const selectVoice = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.requireById)("select-voice")

let voices;

function removeVoiceOptions() {
  for (const child of selectVoice.children) {
    child.remove();
  }
}

function loadVoices() {
  voices = synth.getVoices();
  removeVoiceOptions();
  let chosenVoiceIndex = 0;
  for (let i = 0; i < voices.length; i++) {
    if (!/^pt-/.test(voices[i].lang)) {
      continue;
    }
    const option = document.createElement("option");
    option.textContent = `${voices[i].name} (${voices[i].lang})`;
    option.value = i;
    selectVoice.appendChild(option);
    if (!chosenVoiceIndex && voices[i].lang === 'pt-BR' && voices[i].name.toLowerCase().includes('google')) {
      chosenVoiceIndex = i;
    }
  }
  selectVoice.value = chosenVoiceIndex;
}

// in Google Chrome the voices are not ready on page load
if ("onvoiceschanged" in synth) {
  synth.onvoiceschanged = loadVoices;
} else {
  loadVoices();
}

const speak = (text) => {
  const filtered = text.replace(/\*\*/g, '');
  const utterance = new SpeechSynthesisUtterance(filtered);
  utterance.voice = voices[selectVoice.value];
  synth.speak(utterance);
}


/***/ }),

/***/ "./src/stores/BaseStore.js":
/*!*********************************!*\
  !*** ./src/stores/BaseStore.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BaseStore: () => (/* binding */ BaseStore)
/* harmony export */ });

class BaseStore {
  get key() {} // abstract

  clearStore = () => {
    this._validate();
    localStorage.removeItem(this.key);
  }

  getStore = () => {
    this._validate();
    try {
      const itemRaw = localStorage.getItem(this.key);
      if (!itemRaw) return null;
      return JSON.parse(itemRaw)
    } catch (err) {
      console.warn(err);
      return null;
    }
  }

  setStore = (value) => {
    this._validate();
    try {
      localStorage.setItem(this.key, JSON.stringify(value))
    } catch (err) {
      console.warn(err);
    }
  }

  _validate = () => {
    if (!this.key) throw new Error('local storage key is required');
  }
}

/***/ }),

/***/ "./src/stores/OptionsStore.js":
/*!************************************!*\
  !*** ./src/stores/OptionsStore.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   optionsStore: () => (/* binding */ optionsStore)
/* harmony export */ });
/* harmony import */ var _BaseStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseStore */ "./src/stores/BaseStore.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./src/constants.js");



class OptionsStore extends _BaseStore__WEBPACK_IMPORTED_MODULE_0__.BaseStore {
  get key() {
    return "pt-options"
  }

  _defaultValue = {
    order: _constants__WEBPACK_IMPORTED_MODULE_1__.ORDER.ANY,
    selectedExercises: {
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.VER_CONJATION]: true,
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.VIR_CONJUGATION]: true,
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.WEAK_PHRASES]: true,
    },
  };

  _state = this.getStore() || { ...this._defaultValue };

  /**
   * @returns string
   */
  getOrder = () => this._state.order;

  /**
   * @param {string} val
   */
  setOrder = (val) => {
    this._state.order = val;
    this.setStore(this._state);
  }

  /**
   * @returns object
   */
  getSelectedExercises = () => ({ ...this._state.selectedExercises });

  /**
   * @param {string} exercise
   * @param {boolean} isSelected
   */
  setSelectedExercise = (exercise, isSelected) => {
    this._state.selectedExercises[exercise] = isSelected;
    this.setStore(this._state);
  }

  reset = () => {
    this.clearStore();
    this._state = { ...this._defaultValue };
  }
}

const optionsStore = new OptionsStore();


/***/ }),

/***/ "./src/stores/QuestionsStore.js":
/*!**************************************!*\
  !*** ./src/stores/QuestionsStore.js ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   questionsStore: () => (/* binding */ questionsStore)
/* harmony export */ });
/* harmony import */ var _BaseStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseStore */ "./src/stores/BaseStore.js");


class QuestionsStore extends _BaseStore__WEBPACK_IMPORTED_MODULE_0__.BaseStore {
  get key() {
    return "pt-questions"
  }

  /**
   * Snoozed = key-value pairs of hashed portuguese phrase (sha256), and timeSnoozeExpiresMs
   * ```snoozed: Record<string, number>```
   */
  _defaultValue = {
    snoozed: {},
  };

  _state = this.getStore() || { ...this._defaultValue };

  getSnoozedQuestions = () => ({ ...this._state.snoozed });

  /**
   * @param {string} hash
   * @param {number} snoozeDurationMs
   */
  snoozeQuestion = (hash, snoozeDurationMs) => {
    if (!hash) {
      return false;
    }
    const now = Date.now();
    const timeSnoozeExpiresMs = now + snoozeDurationMs;
    this._state.snoozed[hash] = timeSnoozeExpiresMs;
    this.setStore(this._state);
    return true;
  }

  reset = () => {
    this.clearStore();
    this._state = { ...this._defaultValue };
  }
}

const questionsStore = new QuestionsStore();



/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   assert: () => (/* binding */ assert),
/* harmony export */   removeArrayElement: () => (/* binding */ removeArrayElement),
/* harmony export */   requireById: () => (/* binding */ requireById),
/* harmony export */   sha256: () => (/* binding */ sha256),
/* harmony export */   shuffleArray: () => (/* binding */ shuffleArray)
/* harmony export */ });

function shuffleArray(array) {
  const copy = array.slice()
  for (let i = copy.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    const temp = copy[i];
    copy[i] = copy[j];
    copy[j] = temp;
  }
  return copy;
}

function assert(condition, optText) {
  const result = typeof condition === 'function' ? condition() : condition
  if (!result) {
    throw new Error(optText || 'Assertion Failed!');
  }
}

function requireById(id) {
  const elem = document.getElementById(id);
  if (!elem) throw new Error(`Could not find DOM element with id "${id}"!!`);
  return elem;
}

function removeArrayElement(items, index = -1) {
  if (index < 0) return items;
  if (index >= items.length) return items;
  return items.slice(0, index).concat(items.slice(index + 1))
}

async function sha256(message = '') {
  const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
  const hashBuffer = await window.crypto.subtle.digest("SHA-256", msgUint8); // hash the message
  const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
  const hashHex = hashArray
    .map((b) => b.toString(16).padStart(2, "0"))
    .join(""); // convert bytes to hex string
  return hashHex;
}


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app */ "./src/app.js");


})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBOztBQUVPOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2Q0E7QUFDUDtBQUNBLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQO0FBQ0Esb0VBQW9FLEdBQUc7QUFDdkU7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1Asc0RBQXNEO0FBQ3RELDZFQUE2RTtBQUM3RSw0REFBNEQ7QUFDNUQ7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBOzs7Ozs7O1VDdkNBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7O1dDdEJBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EseUNBQXlDLHdDQUF3QztXQUNqRjtXQUNBO1dBQ0E7Ozs7O1dDUEE7Ozs7O1dDQUE7V0FDQTtXQUNBO1dBQ0EsdURBQXVELGlCQUFpQjtXQUN4RTtXQUNBLGdEQUFnRCxhQUFhO1dBQzdEOzs7Ozs7Ozs7Ozs7QUNOYyIsInNvdXJjZXMiOlsid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9yZXNvdXJjZXMvY29uanVnYXRpb24tdmVyLXZpci55YW1sIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9yZXNvdXJjZXMvd2Vhay1waHJhc2VzLnlhbWwiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL0xvZ2dlci5qcyIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvLi9zcmMvYXBwLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL2tleWJvYXJkVXRpbHMuanMiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL3NwZWFrLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9zdG9yZXMvQmFzZVN0b3JlLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9zdG9yZXMvT3B0aW9uc1N0b3JlLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9zdG9yZXMvUXVlc3Rpb25zU3RvcmUuanMiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB7dmVyOntwcmVzZW50Olt7cHI6J2V1IHZlam8gbyBzb2wgdG9kb3Mgb3MgZGlhcycsZW46J0kgc2VlIHRoZSBzdW4gZXZlcnkgZGF5J30se3ByOidlbGUgdsOqIG9zIHDDoXNzYXJvcyB2b2FuZG8nLGVuOidoZSBzZWVzIHRoZSBiaXJkcyBmbHlpbmcnfSx7cHI6J27Ds3MgdmVtb3MgbyBtYXIgZGFxdWknLGVuOid3ZSBzZWUgdGhlIHNlYSBmcm9tIGhlcmUnfSx7cHI6J2VsZXMgdmVlbSBvcyBhbmltYWlzIG5hIGZsb3Jlc3RhJyxlbjondGhlIHNlZSB0aGUgYW5pbWFscyBpbiB0aGUgZm9yZXN0J31dLGltcGVyZmVjdDpbe3ByOidldSB2aWEgb3MgY2Fycm9zIHBhc3NhcmVtIG5hIHJ1YScsZW46J0kgdXNlZCB0byBzZWUgdGhlIGNhcnMgcGFzc2luZyBpbiB0aGUgcm9hZCd9LHtwcjonZWxlIHZpYSBvcyBhbmltYWlzIG5hIGZsb3Jlc3RhJyxlbjonaGUgdXNlZCB0byBzZWUgdGhlIGFuaW1hbHMgaW4gdGhlIGZvcmVzdCd9LHtwcjonbsOzcyB2w61hbW9zIG8gcMO0ciBkbyBzb2wgbmEgcHJhaWEnLGVuOid3ZSB1c2VkIHRvIHNlZSB0aGUgc3Vuc2V0IG9uIHRoZSBiZWFjaCd9LHtwcjonZWxlcyB2aWFtIGEgbHVhIG5vIGPDqXUnLGVuOid0aGV5IHVzZWQgdG8gc2VlIHRoZSBtb29uIGluIHRoZSBza3knfV0scHJldGVyaXRlOlt7cHI6J2V1IHZpIG8gZmlsbWUgb250ZW0nLGVuOidJIHNhdyB0aGUgZmlsbSB5ZXN0ZXJkYXknfSx7cHI6J2VsZSB2aXUgbyB0cmVtIHBhc3NhcicsZW46J2hlIHNhdyB0aGUgdHJhaW4gcGFzcyd9LHtwcjonbsOzcyB2aW1vcyBvIG1hciBhZ2l0YWRvJyxlbjond2Ugc2F3IHRoZSByb3VnaCBzZWEnfSx7cHI6J2VsZXMgdmlyYW0gbyBlY2xpcHNlIGRhIGx1YScsZW46J3RoZXkgc2F3IHRoZSBlY2xpcHNlIG9mIHRoZSBtb29uJ31dLHByZXNlbnRQZXJmZWN0Olt7cHI6J2V1IHRlbmhvIHZpc3RvIG11aXRvcyBmaWxtZXMgYm9ucycsZW46J0kgaGF2ZSBzZWVuIG1hbnkgZ29vZCBmaWxtcyd9LHtwcjonZWxlIHRlbSB2aXN0byBtdWl0YXMgZXN0cmVsYXMgw6Agbm9pdGUnLGVuOidoZSBoYXMgc2VlbiBtYW55IHN0YXJzIGF0IG5pZ2h0J30se3ByOiduw7NzIHRlbW9zIHZpc3RvIG8gcMO0ciBkbyBzb2wganVudG9zJyxlbjond2UgaGF2ZSBzZWVuIHRoZSBzdW5zZXQgdG9nZXRoZXInfSx7cHI6J2VsZXMgdMOqbSB2aXN0byBvcyBmb2dvcyBkZSBhcnRpZsOtY2lvIG5vIGPDqXUnLGVuOid0aGV5IGhhdmUgc2VlbiB0aGUgZmlyZXdvcmtzIGluIHRoZSBza3knfV0sZnV0dXJlOlt7cHI6J2V1IHZlcmVpIG8gbmFzY2VyIGRvIHNvbCBhbWFuaMOjJyxlbjonSSB3aWxsIHNlZSB0aGUgc3VucmlzZSB0b21vcnJvdyd9LHtwcjonZWxlIHZlcsOhIG9zIGZvZ29zIGRlIGFydGlmw61jaW8gbm8gcmV2ZWlsbG9uJyxlbjonSGUgd2lsbCBzZWUgdGhlIGZpcmV3b3JrcyBvbiBOZXcgWWVhclxcJ3MgRXZlJ30se3ByOiduw7NzIHZlcmVtb3MgbyBtYXIgYXp1bCBuYSB2aWFnZW0nLGVuOid3ZSB3aWxsIHNlZSB0aGUgYmx1ZSBzZWEgb24gdGhlIGpvdXJuZXknfSx7cHI6J2VsZXMgdmVyw6NvIGFzIGZsb3JlcyBubyBqYXJkaW0nLGVuOid0aGV5IHdpbGwgc2VlIHRoZSBmbG93ZXJzIGluIHRoZSBnYXJkZW4nfV19LHZpcjp7cHJlc2VudDpbe3ByOidldSB2ZW5obyBzZW1wcmUgYW8gcGFycXVlJyxlbjonSSBhbHdheXMgY29tZSB0byB0aGUgcGFyayd9LHtwcjonZXUgdGVuaG8gc2F0aXNmYcOnw6NvIHF1YW5kbyBldSB2ZW5obyBhcXVpJyxlbjonSSBoYXZlIHNhdGlzZmFjdGlvbiB3aGVuIEkgY29tZSBoZXJlJ30se3ByOidlbGEgdmVtIG1haXMgdGFyZGUnLGVuOidzaGUgY29tZXMgbGF0ZXInfSx7cHI6J27Ds3Mgdmltb3MgbyBmaWxtZSBqdW50b3MnLGVuOid3ZSBzZWUgdGhlIGZpbG0gdG9nZXRoZXInfSx7cHI6J2VsZXMgdsOqbSBkZSBsb25nZScsZW46J3RoZXkgY29tZSBmcm9tIGFmYXInfV0saW1wZXJmZWN0Olt7cHI6J2V1IHZpbmhhIGFvIHBhcnF1ZSB0b2RvcyBvcyBkaWFzJyxlbjonSSB1c2VkIHRvIGNvbWUgdG8gdGhlIHBhcmsgZXZlcnkgZGF5J30se3ByOidlbGUgdmluaGEgbGVyIGFxdWkgw6AgdGFyZGUnLGVuOidoZSB1c2VkIHRvIGNvbWUgcmVhZCBoZXJlIGluIHRoZSBhZnRlcm5vb24nfSx7cHI6J27Ds3MgdmluaGFtb3Mgc2VtcHJlIGFudGVzIGRvIGphbnRhcicsZW46J3dlIHVzZWQgdG8gYWx3YXlzIGNvbWUgYmVmb3JlIGRpbm5lcid9LHtwcjonZWxlcyB2aW5oYW0gam9nYXIgZnV0ZWJvbCB0b2RhcyBhcyB0YXJkZXMnLGVuOid0aGV5IHVzZWQgdG8gY29tZSBwbGF5IHNvY2NlciBldmVyeSBhZnRlcm5vb24nfV0scHJldGVyaXRlOlt7cHI6J2V1IHZpbSDDoCBwcmFpYSBob2plJyxlbjonSSBjYW1lIHRvIHRoZSBiZWFjaCB0b2RheSd9LHtwcjonZWxlIHZlaW8gYWp1ZGFyIGEgYXbDsycsZW46J2hlIGNhbWUgdG8gaGVscCBoaXMgZ3JhbmRtb3RoZXInfSx7cHI6J27Ds3MgdmllbW9zIGFsbW/Dp2FyIGNvbnRpZ28nLGVuOid3ZSBjYW1lIHRvIGhhdmUgbHVuY2ggd2l0aCB5b3UnfSx7cHI6J2VsZXMgdmllcmFtIHLDoXBpZG8gZGVtYWlzJyxlbjondGhleSBjYW1lIHRvbyBmYXN0J31dLHByZXNlbnRQZXJmZWN0Olt7cHI6J2V1IHRlaG5vIHZpbmRvIGFxdWkgY29tIGZyZXF1w6puY2lhJyxlbjonSSBoYXZlIGJlZW4gY29taW5nIGhlcmUgb2Z0ZW4nfSx7cHI6J2VsZSB0ZW0gdmluZG8gYWp1ZGFyIG9zIG91dHJvcycsZW46J2hlIGhhcyBiZWVuIGNvbWluZyB0byBoZWxwIG90aGVycyd9LHtwcjonbsOzcyB0ZW1vcyB2aW5kbyBwYXNzZWFyIG5vIHBhcnF1ZScsZW46J3dlIGhhdmUgYmVlbiBjb21pbmcgZm9yIGEgd2FsayBpbiB0aGUgcGFyayd9LHtwcjonZWxlcyB0w6ptIHZpbmRvIGJyaW5jYXIgbm8gcGFycXVlJyxlbjondGhleSBoYXZlIGJlZW4gY29taW5nIHRvIHBsYXkgaW4gdGhlIHBhcmsnfV0sZnV0dXJlOlt7cHI6J2V1IHZpcmVpIGJ1c2NhciB2b2PDqiBtYWlzIHRhcmRlJyxlbjonSSB3aWxsIGNvbWUgZmluZCB5b3UgbGF0ZXInfSx7cHI6J2VsZSB2aXLDoSBhanVkYXIgbmEgZmVzdGEnLGVuOidoZSB3aWxsIGNvbWUgaGVscCBhdCB0aGUgcGFydHknfSx7cHI6J27Ds3MgdmlyZW1vcyBqYW50YXIganVudG9zJyxlbjond2Ugd2lsbCBjb21lIHRvIGRpbm5lciB0b2dldGhlcid9LHtwcjonZWxlcyB2aXLDo28gbm8gcHLDs3hpbW8gZmluYWwgZGUgc2VtYW5hJyxlbjondGhleSB3aWxsIGNvbWUgbmV4dCB3ZWVrZW5kJ31dfX07IiwiZXhwb3J0IGRlZmF1bHQgW3twcjonRWxlIMOpIHVtIGNvbGVjaW9uYWRvciBxdWUgY29sZWNpb25hIGl0ZW5zJyxlbjonSGUgaXMgYSBjb2xsZWN0b3Igd2hvIGNvbGxlY3RzIGl0ZW1zJ30se3ByOidUZW5obyB1bWEgY29sZcOnw6NvJyxlbjonSSBoYXZlIGEgY29sbGVjdGlvbid9LHtwcjonVm91ICoqZ2FuaGFyKiogbWFpcyBkaW5oZWlybyBuYXF1ZWxhIGhvcmEnLGVuOidJIHdpbGwgKipnZXQqKiBtb3JlIG1vbmV5IGF0IHRoYXQgdGltZSd9LHtwcjonRm9pIGVzY3VybyBsw6EgZm9yYScsZW46J0l0IHdhcyBkYXJrIG91dHNpZGUnfSx7cHI6J0VzdMOhIGZpY2FuZG8gb3NjdXJvIGzDoSBmb3JhJyxlbjonSXQgaXMgZ2V0dGluZyBkYXJrIG91dHNpZGUnfSx7cHI6J1ZlbmhhIG1lIGNvbmhlY2VyIGFsZ3VtIGRpYScsZW46J0NvbWUgYW5kIG1lZXQgbWUgc29tZSBkYXknfSx7cHI6J1ZlbmhhIG1lIHZlciBhbGd1bSBkaWEnLGVuOidDb21lIGFuZCBzZWUgbWUgc29tZSBkYXknfSx7cHI6J07Do28gcGVyY2EgYSBmw6knLGVuOidEbyBub3QgbG9zZSBmYWl0aCd9LHtwcjonRWxlIG7Do28gcGVyZGUgYSBmw6knLGVuOidIZSBkb2VzIG5vdCBsb3NlIGZhaXRoJ30se3ByOidFbGEgbWUgYXByZXNlbnRvdSBhbyBzZXUgbmFtb3JhZG8gbmEgZmVzdGEnLGVuOidTaGUgaW50cm9kdWNlZCBtZSB0byBoZXIgYm95ZnJpZW5kIGF0IHRoZSBwYXJ0eSd9LHtwcjonRWxlIGxldm91IG1ldSBjYXNhY28nLGVuOidIZSB0b29rIG15IGNvYXQnfSx7cHI6J0V1IHRlIGRvdSBlc3RlIHJlbMOzZ2lvIGNvbW8gdW0gcHJlc2VudGUnLGVuOidJIGdpdmUgdGhpcyB3YXRjaCB0byB5b3UgYXMgYSBnaWZ0J30se3ByOidFdSBzb25oZWkgdW0gc29uaG8gZGUgdW0gdGVtcG8gcGFzc2FkbycsZW46J0kgZHJlYW1lZCBhIGRyZWFtIG9mIHRpbWUgZ29uZSBieSd9LHtwcjonRXUgbWUgZGl2ZXJ0aSBtdWl0bycsZW46J0kgaGFkIGEgZ29vZCB0aW1lJ30se3ByOidGb2kgdW0gYm9tIG1vbWVudG8nLGVuOidJdCB3YXMgYSBnb29kIHRpbWUnfSx7cHI6J0VsZSB2ZWlvIGRlIGxvbmdlJyxlbjonSGUgY2FtZSBmcm9tIGZhciBhd2F5J30se3ByOidFc3RvdSB2aW5kbycsZW46J0kgYW0gY29taW5nJ30se3ByOidDb250aW51ZSBlbSBmcmVudGUsIHBvciBmYXZvcicsZW46J0tlZXAgZ29pbmcgZm9yd2FyZCwgcGxlYXNlJ30se3ByOidBIGx1eiDDqSBicmlsaGFudGUnLGVuOidUaGUgbGlnaHQgaXMgYnJpZ2h0J30se3ByOifDiSBmYXZvcsOhdmVsIHBhcmEgbsOzcyBpcm1vcycsZW46J0l0IGlzIGZhdm9yYWJsZSBmb3IgdXMgdG8gZ28nfSx7cHI6J0V1IHBlbnNlaSBxdWUgbm9zc28gKipjb21wcm9taXNzbyoqIHNlcmlhIG5hIHNlbWFuYSBxdWUgdmVtJyxlbjonSSB0aG91Z2h0IHRoYXQgb3VyICoqbWVldGluZyoqIHdhcyBuZXh0IHdlZWsnfSx7cHI6J0lzc28gbsOjbyBxdWVyIGRpemVyIG5hZGEnLGVuOidUaGlzIGRvZXNuXFwndCBtZWFuIGFueXRoaW5nJ30se3ByOidFbGVzIG1lICoqZMOjbyoqIGFycm96JyxlbjonVGhleSAqKmdpdmUqKiBtZSByaWNlJ30se3ByOidFbGUgbsOjbyBkZXZlIHZpciBhcXVpIG5vdmFtZW50ZScsZW46J0hlIG11c3Qgbm90IGNvbWUgaGVyZSBhZ2Fpbid9LHtwcjonSMOhIG91dHJvcyBmYXRvcmVzIHF1ZSBub3MgZmF6ZW0gcGVuc2FyIGFzc2ltJyxlbjonVGhlcmUgYXJlIG90aGVyIGZhY3RvcnMgdGhhdCBtYWtlIHVzIHRoaW5rIGxpa2UgdGhhdCd9LHtwcjonRWxhIG5vcyBleHBsb3JhJyxlbjonU2hlIGV4cGxvaXRzIHVzJ30se3ByOidPIHJlc3RhdXJhbnRlIGZpY2EgZW0gZnJlbnRlIMOgIGVzY29sYScsZW46J1RoZSByZXN0YXVyYW50IGlzIGluIGZyb250IG9mIHRoZSBzY2hvb2wnfSx7cHI6J0VzdGUgw6kgbWV1IHRpcG8gZGUgcGVyc29uYWdlbScsZW46J1RoaXMgaXMgbXkgdHlwZSBvZiBjaGFyYWN0ZXInfSx7cHI6J0V1IG7Do28gdmVqbyBtaW5oYSBuYW1vcmFkYSBow6EgZHVhcyBzZW1hbmFzJyxlbjonSSBoYXZlIG5vdCBzZWVuIG15IGdpcmxmcmllbmQgZm9yIHR3byB3ZWVrcyd9LHtwcjonQ29tbyB0ZW0gcGFzc2FkbyBvIHNldSBwYWk/JyxlbjonSG93IGhhcyB5b3VyIGZhdGhlciBiZWVuPyd9LHtwcjonTWV1IGZpbGhvIHRlbSBtZSBwZXJndW50YWRvICoqY29pc2FzIGVzdHJhbmhhcyoqJyxlbjonTXkgc29uIGhhcyBiZWVuIGFza2luZyBtZSAqKnN0cmFuZ2UgcXVlc3Rpb25zKionfSx7cHI6J1RlbnRlIGRlc2NvYnJpciBzZSB0dWRvIHF1ZSBlbGUgZGlzc2Ugw6kgdmVyZGFkZScsZW46J1RyeSB0byBmaW5kIG91dCBpZiBldmVyeXRoaW5nIHRoYXQgaGUgc2FpZCBpcyB0cnVlJ30se3ByOidFbGUgbWUgY29udGEgdHVkbycsZW46J0hlIHRlbGxzIG1lIGV2ZXJ5dGhpbmcnfSx7cHI6J0V1IHNlZ3VyZWkgdW0gYmViw6kgZW0gbWV1cyBicmHDp29zJyxlbjonSSBoZWxkIGEgYmFieSBpbiBteSBhcm1zJ31dOyIsIlxuZXhwb3J0IGNvbnN0IExvZ2dlciA9IHtcbiAgX2VuYWJsZWQ6IGZhbHNlLFxuICBfZGVidWc6IGZhbHNlLFxuXG4gIGVuYWJsZSgpIHtcbiAgICBMb2dnZXIuX2VuYWJsZWQgPSB0cnVlO1xuICB9LFxuXG4gIGRpc2FibGUoKSB7XG4gICAgTG9nZ2VyLl9lbmFibGVkID0gZmFsc2U7XG4gIH0sXG5cbiAgZW5hYmxlRGVidWcoKSB7XG4gICAgTG9nZ2VyLl9kZWJ1ZyA9IHRydWU7XG4gIH0sXG5cbiAgZGlzYWJsZURlYnVnKCkge1xuICAgIExvZ2dlci5fZGVidWcgPSBmYWxzZTtcbiAgfSxcblxuICBkZWJ1ZyguLi5hcmdzKSB7XG4gICAgaWYgKCFMb2dnZXIuX2VuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFMb2dnZXIuX2RlYnVnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKC4uLmFyZ3MpO1xuICB9LFxuXG4gIGluZm8oLi4uYXJncykge1xuICAgIGlmICghTG9nZ2VyLl9lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKC4uLmFyZ3MpO1xuICB9LFxuXG4gIHdhcm4oLi4uYXJncykge1xuICAgIGlmICghTG9nZ2VyLl9lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnNvbGUud2FybiguLi5hcmdzKTtcbiAgfSxcblxuICBlcnJvciguLi5hcmdzKSB7XG4gICAgLy8gYWx3YXlzIHNob3cgZXJyb3JzXG4gICAgY29uc29sZS5lcnJvciguLi5hcmdzKTtcbiAgfSxcbn1cbiIsImltcG9ydCBjb25qIGZyb20gJy4vcmVzb3VyY2VzL2Nvbmp1Z2F0aW9uLXZlci12aXIueWFtbCc7XG5pbXBvcnQgd2Vha1BocmFzZXMgZnJvbSAnLi9yZXNvdXJjZXMvd2Vhay1waHJhc2VzLnlhbWwnO1xuXG5pbXBvcnQgeyBFWEVSQ0lTRSwgT1JERVIgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBpc0NoYXJQcmVzc2VkLCBTcGVjaWFsS2V5IH0gZnJvbSAnLi9rZXlib2FyZFV0aWxzJztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4vTG9nZ2VyJztcbmltcG9ydCB7IHNwZWFrIH0gZnJvbSAnLi9zcGVhayc7XG5pbXBvcnQgeyBvcHRpb25zU3RvcmUgfSBmcm9tICcuL3N0b3Jlcy9PcHRpb25zU3RvcmUnO1xuaW1wb3J0IHsgcXVlc3Rpb25zU3RvcmUgfSBmcm9tICcuL3N0b3Jlcy9RdWVzdGlvbnNTdG9yZSc7XG5pbXBvcnQgeyBhc3NlcnQsIHJlbW92ZUFycmF5RWxlbWVudCwgcmVxdWlyZUJ5SWQsIHNoYTI1Niwgc2h1ZmZsZUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG5cbkxvZ2dlci5lbmFibGUoKTtcbkxvZ2dlci5kaXNhYmxlRGVidWcoKTtcblxuY29uc3QgY2FyZFF1ZXN0aW9uID0gcmVxdWlyZUJ5SWQoJ2NhcmQtcXVlc3Rpb24nKTtcbmNvbnN0IGNhcmRBbnN3ZXIgPSByZXF1aXJlQnlJZCgnY2FyZC1hbnN3ZXInKTtcbmNvbnN0IGNhcmRRdWVzdGlvbkNvbnRlbnQgPSBjYXJkUXVlc3Rpb24uY2hpbGRyZW5bMF1cbmNvbnN0IGNhcmRBbnN3ZXJDb250ZW50ID0gY2FyZEFuc3dlci5jaGlsZHJlblswXVxuXG5hc3NlcnQoY2FyZFF1ZXN0aW9uQ29udGVudCwgJ2NhcmRRdWVzdGlvbkNvbnRlbnQgZG9lcyBub3QgZXhpc3QnKTtcbmFzc2VydChjYXJkQW5zd2VyQ29udGVudCwgJ2NhcmRBbnN3ZXJDb250ZW50IGRvZXMgbm90IGV4aXN0Jyk7XG5cbmNvbnN0IGJ1dHRvblByZXYgPSByZXF1aXJlQnlJZCgnYnV0dG9uLXByZXYnKTtcbmNvbnN0IGJ1dHRvbk5leHQgPSByZXF1aXJlQnlJZCgnYnV0dG9uLW5leHQnKTtcbmNvbnN0IGJ1dHRvblJlc2h1ZmZsZSA9IHJlcXVpcmVCeUlkKCdidXR0b24tcmVzaHVmZmxlJyk7XG5jb25zdCBidXR0b25TcGVhayA9IHJlcXVpcmVCeUlkKCdidXR0b24tc3BlYWsnKTtcbmNvbnN0IGJ1dHRvblNub296ZTFoID0gcmVxdWlyZUJ5SWQoJ2J1dHRvbi1zbm9vemUtMWgnKTtcbmNvbnN0IGJ1dHRvblNub296ZTdkID0gcmVxdWlyZUJ5SWQoJ2J1dHRvbi1zbm9vemUtN2QnKTtcbmNvbnN0IGJ1dHRvblNub296ZTMwZCA9IHJlcXVpcmVCeUlkKCdidXR0b24tc25vb3plLTMwZCcpO1xuY29uc3QgcHJvZ3Jlc3MgPSByZXF1aXJlQnlJZCgncHJvZ3Jlc3MnKTtcbmNvbnN0IGZvcm1RdWVzdGlvbk9yZGVyID0gcmVxdWlyZUJ5SWQoJ2Zvcm0tcXVlc3Rpb24tb3JkZXInKTtcbmNvbnN0IGZvcm1TZWxlY3RFeGVyY2lzZXMgPSByZXF1aXJlQnlJZCgnZm9ybS1zZWxlY3QtZXhlcmNpc2VzJyk7XG5cbmNvbnN0IHN0YXRlID0ge1xuICByZXZlYWxlZDogZmFsc2UsXG4gIHByb2JsZW1zOiBbXSwgLy8gYXJyYXkgb2YgdHVwbGVzIC0+IFtxdWVzdGlvbiwgYW5zd2VyLCBwb3J0dWd1ZXNlLWluZGV4LWZvci10ZXh0LXRvLXNwZWVjaF1bXVxuICBpbmRleDogMCxcbiAgb3JkZXI6IG9wdGlvbnNTdG9yZS5nZXRPcmRlcigpLFxuICBzZWxlY3RlZEV4ZXJjaXNlczogb3B0aW9uc1N0b3JlLmdldFNlbGVjdGVkRXhlcmNpc2VzKCksXG59O1xuXG5mdW5jdGlvbiBtYWluKCkge1xuICByZW5kZXJPcHRpb25zKCk7XG4gIHNodWZmbGVRdWVzdGlvbnMoKTtcbiAgc2V0dXBMaXN0ZW5lcnMoKTtcbn1cblxuZnVuY3Rpb24gcmFuZEJvb2woKSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpID49IDAuNVxufVxuXG5mdW5jdGlvbiBzaHVmZmxlUXVlc3Rpb25zKCkge1xuICBzdGF0ZS5yZXZlYWxlZCA9IGZhbHNlO1xuICBzdGF0ZS5wcm9ibGVtcyA9IFtdO1xuICBzdGF0ZS5pbmRleCA9IDA7XG4gIGNvbnN0IHByb2JsZW1zID0gW11cbiAgY29uc3QgYWRkUHJvYmxlbSA9IChwcm9ibGVtKSA9PiB7XG4gICAgaWYgKCFwcm9ibGVtLmVuIHx8ICFwcm9ibGVtLnByKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb2JsZW0gaXMgaW52YWxpZDogJHtKU09OLnN0cmluZ2lmeShwcm9ibGVtKX1gKVxuICAgIH1cbiAgICBpZiAoc3RhdGUub3JkZXIgPT09IE9SREVSLkVOX0ZJUlNUKSB7XG4gICAgICBwcm9ibGVtcy5wdXNoKFtwcm9ibGVtLmVuLCBwcm9ibGVtLnByLCAxXSk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZS5vcmRlciA9PT0gT1JERVIuUFJfRklSU1QpIHtcbiAgICAgIHByb2JsZW1zLnB1c2goW3Byb2JsZW0ucHIsIHByb2JsZW0uZW4sIDBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZmxpcCA9IHJhbmRCb29sKCk7XG4gICAgICBpZiAoZmxpcCkge1xuICAgICAgICBwcm9ibGVtcy5wdXNoKFtwcm9ibGVtLmVuLCBwcm9ibGVtLnByLCAxXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9ibGVtcy5wdXNoKFtwcm9ibGVtLnByLCBwcm9ibGVtLmVuLCAwXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW0VYRVJDSVNFLlZFUl9DT05KQVRJT05dKSB7XG4gICAgY29uai52ZXIucHJlc2VudC5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICAgIGNvbmoudmVyLnByZXRlcml0ZS5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICAgIGNvbmoudmVyLmltcGVyZmVjdC5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICAgIGNvbmoudmVyLnByZXNlbnRQZXJmZWN0LmZvckVhY2goYWRkUHJvYmxlbSk7XG4gICAgY29uai52ZXIuZnV0dXJlLmZvckVhY2goYWRkUHJvYmxlbSk7XG4gIH1cblxuICBpZiAoc3RhdGUuc2VsZWN0ZWRFeGVyY2lzZXNbRVhFUkNJU0UuVklSX0NPTkpVR0FUSU9OXSkge1xuICAgIGNvbmoudmlyLnByZXNlbnQuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZpci5wcmV0ZXJpdGUuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZpci5pbXBlcmZlY3QuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZpci5wcmVzZW50UGVyZmVjdC5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICAgIGNvbmoudmlyLmZ1dHVyZS5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICB9XG5cbiAgaWYgKHN0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW0VYRVJDSVNFLldFQUtfUEhSQVNFU10pIHtcbiAgICB3ZWFrUGhyYXNlcy5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICB9XG5cbiAgc3RhdGUucHJvYmxlbXMgPSBzaHVmZmxlQXJyYXkocHJvYmxlbXMpO1xuXG4gIHByZXBhcmVIYXNoRGF0YSgoKSA9PiB7XG4gICAgcmVuZGVyQ29udGVudCgpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcGxheVRyYW5zbGF0aW9uQXVkaW8oKSB7XG4gIGNvbnN0IG51bVByb2JsZW1zID0gc3RhdGUucHJvYmxlbXMubGVuZ3RoXG5cbiAgaWYgKG51bVByb2JsZW1zID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY3VycmVudEluZGV4ID0gc3RhdGUuaW5kZXggJSBudW1Qcm9ibGVtcztcbiAgY29uc3QgY3VycmVudFByb2JsZW0gPSBzdGF0ZS5wcm9ibGVtc1tjdXJyZW50SW5kZXhdO1xuICBzcGVhayhjdXJyZW50UHJvYmxlbVtjdXJyZW50UHJvYmxlbVsyXV0pXG59XG5cbmZ1bmN0aW9uIGFkdmFuY2UoKSB7XG4gIGlmIChzdGF0ZS5yZXZlYWxlZCkge1xuICAgIHN0YXRlLmluZGV4Kys7XG4gICAgc3RhdGUucmV2ZWFsZWQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBzdGF0ZS5yZXZlYWxlZCA9IHRydWU7XG4gIH1cbiAgcmVuZGVyQ29udGVudCgpO1xufVxuXG5mdW5jdGlvbiByZXdpbmQoKSB7XG4gIHN0YXRlLnJldmVhbGVkID0gZmFsc2U7XG4gIHN0YXRlLmluZGV4LS07XG4gIGlmIChzdGF0ZS5pbmRleCA8IDApIHN0YXRlLmluZGV4ID0gc3RhdGUucHJvYmxlbXMubGVuZ3RoIC0gMTtcbiAgcmVuZGVyQ29udGVudCgpO1xufVxuXG5mdW5jdGlvbiBzZXR1cExpc3RlbmVycygpIHtcbiAgYnV0dG9uTmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFkdmFuY2UpO1xuICBidXR0b25QcmV2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmV3aW5kKTtcbiAgYnV0dG9uUmVzaHVmZmxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2h1ZmZsZVF1ZXN0aW9ucyk7XG4gIGJ1dHRvblNwZWFrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheVRyYW5zbGF0aW9uQXVkaW8pO1xuICBidXR0b25Tbm9vemUxaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUNsaWNrU25vb3plKTtcbiAgYnV0dG9uU25vb3plN2QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDbGlja1Nub296ZSk7XG4gIGJ1dHRvblNub296ZTMwZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUNsaWNrU25vb3plKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleVByZXNzKTtcbiAgZm9ybVF1ZXN0aW9uT3JkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlUXVlc3Rpb25PcmRlckNoYW5nZSlcbiAgZm9ybVNlbGVjdEV4ZXJjaXNlcy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVTZWxlY3RFeGVyY2lzZUNoZWNrKVxufVxuXG4vKipcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqL1xuZnVuY3Rpb24gaGFuZGxlS2V5UHJlc3MoZXYpIHtcbiAgaWYgKCFldikgcmV0dXJuO1xuXG4gIGlmIChpc0NoYXJQcmVzc2VkKGV2LCBTcGVjaWFsS2V5LkFycm93UmlnaHQpKSB7XG4gICAgYWR2YW5jZSgpO1xuICB9IGVsc2UgaWYgKGlzQ2hhclByZXNzZWQoZXYsIFNwZWNpYWxLZXkuQXJyb3dMZWZ0KSkge1xuICAgIHJld2luZCgpO1xuICB9IGVsc2UgaWYgKGlzQ2hhclByZXNzZWQoZXYsIFNwZWNpYWxLZXkuU3BhY2UpKSB7XG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICBwbGF5VHJhbnNsYXRpb25BdWRpbygpO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldlxuICovXG5mdW5jdGlvbiBoYW5kbGVRdWVzdGlvbk9yZGVyQ2hhbmdlKGV2KSB7XG4gIHN0YXRlLm9yZGVyID0gZXYudGFyZ2V0LnZhbHVlO1xuICBvcHRpb25zU3RvcmUuc2V0T3JkZXIoZXYudGFyZ2V0LnZhbHVlKTtcbiAgc2h1ZmZsZVF1ZXN0aW9ucygpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqL1xuZnVuY3Rpb24gaGFuZGxlU2VsZWN0RXhlcmNpc2VDaGVjayhldikge1xuICBzdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlc1tldi50YXJnZXQubmFtZV0gPSBldi50YXJnZXQuY2hlY2tlZDtcbiAgb3B0aW9uc1N0b3JlLnNldFNlbGVjdGVkRXhlcmNpc2UoZXYudGFyZ2V0Lm5hbWUsIGV2LnRhcmdldC5jaGVja2VkKTtcbiAgc2h1ZmZsZVF1ZXN0aW9ucygpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDbGlja1Nub296ZShldikge1xuICBjb25zdCBzZWNvbmRzID0gcGFyc2VJbnQoZXYuY3VycmVudFRhcmdldC5kYXRhc2V0LnNlY29uZHMsIDEwKSB8fCAwO1xuICBpZiAoIXNlY29uZHMpIHJldHVybjtcbiAgY29uc3Qgc25vb3plRHVyYXRpb25NcyA9IHNlY29uZHMgKiAxMDAwO1xuICBzbm9vemVDdXJyZW50UXVlc3Rpb24oc25vb3plRHVyYXRpb25Ncyk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNvbnRlbnQoKSB7XG4gIGNvbnN0IG51bVByb2JsZW1zID0gc3RhdGUucHJvYmxlbXMubGVuZ3RoXG5cbiAgaWYgKG51bVByb2JsZW1zID09PSAwKSB7XG4gICAgY2FyZFF1ZXN0aW9uQ29udGVudC5pbm5lckhUTUwgPSBcIlBsZWFzZSBzZWxlY3QgYW4gZXhlcmNpc2UgdG8gYmVnaW5cIjtcbiAgICBjYXJkQW5zd2VyQ29udGVudC5pbm5lckhUTUwgPSBcIlBvciBmYXZvciBzZWxlY2lvbmUgdW0gZXhlcmPDrWNpbyBwYXJhIGNvbWXDp2FyXCI7XG4gICAgY2FyZEFuc3dlci5jbGFzc0xpc3QuYWRkKCdyZXZlYWxlZCcpO1xuICAgIHByb2dyZXNzLmlubmVySFRNTCA9IFwiMCAvIDBcIjtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBjdXJyZW50SW5kZXggPSBzdGF0ZS5pbmRleCAlIG51bVByb2JsZW1zO1xuICBjb25zdCBwcm9ncmVzc1RleHQgPSBgJHtjdXJyZW50SW5kZXggKyAxfSAvICR7bnVtUHJvYmxlbXN9YFxuICBjb25zdCBjdXJyZW50UHJvYmxlbSA9IHN0YXRlLnByb2JsZW1zW2N1cnJlbnRJbmRleF07XG5cbiAgYXNzZXJ0KGN1cnJlbnRQcm9ibGVtLCBgY3VycmVudFByb2JsZW0gb3V0IG9mIGJvdW5kcyAtIHRyaWVkIGluZGV4ICR7Y3VycmVudEluZGV4fSBmb3IgYXJyYXkgb2YgbGVuZ3RoICR7bnVtUHJvYmxlbXN9YCk7XG5cbiAgY2FyZFF1ZXN0aW9uQ29udGVudC5pbm5lckhUTUwgPSBtYXJraWZ5VGV4dChjdXJyZW50UHJvYmxlbVswXSk7XG4gIGNhcmRBbnN3ZXJDb250ZW50LmlubmVySFRNTCA9IG1hcmtpZnlUZXh0KGN1cnJlbnRQcm9ibGVtWzFdKTtcblxuICBpZiAoc3RhdGUucmV2ZWFsZWQpIHtcbiAgICBjYXJkQW5zd2VyLmNsYXNzTGlzdC5hZGQoJ3JldmVhbGVkJyk7XG4gIH0gZWxzZSB7XG4gICAgY2FyZEFuc3dlci5jbGFzc0xpc3QucmVtb3ZlKCdyZXZlYWxlZCcpO1xuICB9XG5cbiAgcHJvZ3Jlc3MuaW5uZXJIVE1MID0gcHJvZ3Jlc3NUZXh0O1xufVxuXG5mdW5jdGlvbiByZW5kZXJPcHRpb25zKCkge1xuICBmb3JtUXVlc3Rpb25PcmRlci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpLmZvckVhY2goaW5wdXQgPT4ge1xuICAgIGlmIChpbnB1dC5uYW1lID09PSAncXVlc3Rpb24tb3JkZXInKSB7XG4gICAgICBpbnB1dC5jaGVja2VkID0gc3RhdGUub3JkZXIgPT09IGlucHV0LnZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgZm9ybVNlbGVjdEV4ZXJjaXNlcy5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpLmZvckVhY2goaW5wdXQgPT4ge1xuICAgIGlmIChpbnB1dC5uYW1lLmluY2x1ZGVzKCdjaGVja2JveC1leGVyY2lzZScpKSB7XG4gICAgICBpbnB1dC5jaGVja2VkID0gc3RhdGUuc2VsZWN0ZWRFeGVyY2lzZXNbaW5wdXQubmFtZV07XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dFxuICogQHJldHVybnMgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIG1hcmtpZnlUZXh0KHRleHQpIHtcbiAgY29uc3QgcmVnTWFya2Rvd25Cb2xkU3RhcnQgPSAvKD88IVxcUylcXCpcXCooPyFcXHMpL2c7XG4gIGNvbnN0IHJlZ01hcmtkb3duQm9sZEVuZCA9IC8oPzwhXFxzKVxcKlxcKig/IVxcUykvZztcbiAgcmV0dXJuIHRleHRcbiAgICAucmVwbGFjZShyZWdNYXJrZG93bkJvbGRTdGFydCwgXCI8c3Ryb25nIGNsYXNzPVxcXCJhY2NlbnRcXFwiPlwiKVxuICAgIC5yZXBsYWNlKHJlZ01hcmtkb3duQm9sZEVuZCwgXCI8L3N0cm9uZz5cIilcbn1cblxuZnVuY3Rpb24gc25vb3plQ3VycmVudFF1ZXN0aW9uKHNub296ZUR1cmF0aW9uTXMpIHtcbiAgY29uc3QgbnVtUHJvYmxlbXMgPSBzdGF0ZS5wcm9ibGVtcy5sZW5ndGhcbiAgaWYgKG51bVByb2JsZW1zID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGN1cnJlbnRJbmRleCA9IHN0YXRlLmluZGV4ICUgbnVtUHJvYmxlbXM7XG4gIGNvbnN0IGN1cnJlbnRQcm9ibGVtID0gc3RhdGUucHJvYmxlbXNbY3VycmVudEluZGV4XTtcbiAgY29uc3QgaGFzaCA9IGN1cnJlbnRQcm9ibGVtWzNdO1xuICBpZiAocXVlc3Rpb25zU3RvcmUuc25vb3plUXVlc3Rpb24oaGFzaCwgc25vb3plRHVyYXRpb25NcykpIHtcbiAgICBzdGF0ZS5wcm9ibGVtcyA9IHJlbW92ZUFycmF5RWxlbWVudChzdGF0ZS5wcm9ibGVtcywgY3VycmVudEluZGV4KTtcbiAgICBzdGF0ZS5yZXZlYWxlZCA9IGZhbHNlO1xuICAgIHJlbmRlckNvbnRlbnQoKTtcbiAgfVxufVxuXG5sZXQgY2xlYW51cEhhc2hQcm9jZXNzb3IgPSBudWxsO1xuXG4vKipcbiAqIEhhc2ggUG9ydHVndWVzZSBwaHJhc2UgdG8gYWxsb3cgZm9yIFwic25vb3ppbmdcIiBhIGZsYXNoIGNhcmRcbiAqL1xuZnVuY3Rpb24gcHJlcGFyZUhhc2hEYXRhKG9uUHJvY2Vzc2luZ0NvbXBsZXRlID0gKCkgPT4ge30pIHtcbiAgaWYgKGNsZWFudXBIYXNoUHJvY2Vzc29yKSB7XG4gICAgY2xlYW51cEhhc2hQcm9jZXNzb3IoKTtcbiAgfVxuXG4gIGxldCBpZ25vcmUgPSBmYWxzZTtcblxuICBhc3luYyBmdW5jdGlvbiBwcm9jZXNzKCkge1xuICAgIGNvbnN0IHRpbWVTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIGxldCBpID0gMDtcbiAgICB3aGlsZSAoIWlnbm9yZSAmJiBpIDwgc3RhdGUucHJvYmxlbXMubGVuZ3RoKSB7XG4gICAgICBjb25zdCBwcm9ibGVtID0gc3RhdGUucHJvYmxlbXNbaV07XG4gICAgICBjb25zdCBwdFBocmFzZSA9IHByb2JsZW1bcHJvYmxlbVsyXV07XG4gICAgICBjb25zdCBoYXNoID0gYXdhaXQgc2hhMjU2KHB0UGhyYXNlKTtcbiAgICAgIHN0YXRlLnByb2JsZW1zW2ldWzNdID0gaGFzaDtcbiAgICAgIExvZ2dlci5kZWJ1ZyhgcHJvY2Vzc2luZyBtc2cgJHtpfSAtICR7aGFzaH0gZ2VuZXJhdGVkIGZvciBcIiR7cHRQaHJhc2V9XCJgKVxuICAgICAgaSsrO1xuICAgIH1cbiAgICBpZiAoIWlnbm9yZSkge1xuICAgICAgY29uc3Qgc25vb3plZFF1ZXN0aW9ucyA9IHF1ZXN0aW9uc1N0b3JlLmdldFNub296ZWRRdWVzdGlvbnMoKTtcbiAgICAgIHN0YXRlLnByb2JsZW1zID0gc3RhdGUucHJvYmxlbXMuZmlsdGVyKHByb2JsZW0gPT4ge1xuICAgICAgICBjb25zdCBoYXNoID0gcHJvYmxlbVszXTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zdCB0aW1lU25vb3plRXhwaXJlc01zID0gc25vb3plZFF1ZXN0aW9uc1toYXNoXSB8fCAwO1xuICAgICAgICByZXR1cm4gISFoYXNoICYmIHRpbWVTbm9vemVFeHBpcmVzTXMgPCBjdXJyZW50VGltZVxuICAgICAgfSlcblxuICAgICAgY29uc3QgdGltZUVuZCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgTG9nZ2VyLmluZm8oYHByb2Nlc3NpbmcgY29tcGxldGUhIC0gdG9vayAke3RpbWVFbmQgLSB0aW1lU3RhcnR9bXNgKTtcbiAgICAgIG9uUHJvY2Vzc2luZ0NvbXBsZXRlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJvY2VzcygpO1xuXG4gIGNsZWFudXBIYXNoUHJvY2Vzc29yID0gKCkgPT4ge1xuICAgIGlnbm9yZSA9IHRydWU7XG4gICAgY2xlYW51cEhhc2hQcm9jZXNzb3IgPSBudWxsO1xuICB9XG59XG5cbm1haW4oKTtcbiIsIlxuZXhwb3J0IGNvbnN0IE9SREVSID0ge1xuICBQUl9GSVJTVDogJ3ByLWZpcnN0JyxcbiAgRU5fRklSU1Q6ICdlbi1maXJzdCcsXG4gIEFOWTogJ2FueScsXG59XG5cbmV4cG9ydCBjb25zdCBFWEVSQ0lTRSA9IHtcbiAgVkVSX0NPTkpBVElPTjogJ2NoZWNrYm94LWV4ZXJjaXNlLXZlci1jb25qdWdhdGlvbicsXG4gIFZJUl9DT05KVUdBVElPTjogJ2NoZWNrYm94LWV4ZXJjaXNlLXZpci1jb25qdWdhdGlvbicsXG4gIFdFQUtfUEhSQVNFUzogJ2NoZWNrYm94LWV4ZXJjaXNlLXdlYWstcGhyYXNlcycsXG59XG4iLCJcbmV4cG9ydCBjb25zdCBTcGVjaWFsS2V5ID0ge1xuICBCYWNrc3BhY2U6ICdiYWNrc3BhY2UnLFxuICBFc2NhcGU6ICdlc2NhcGUnLFxuICBUYWI6ICd0YWInLFxuICBTcGFjZTogJ3NwYWNlJyxcbiAgRW50ZXI6ICdlbnRlcicsXG4gIERlbGV0ZTogJ2RlbGV0ZScsXG4gIEFycm93VXA6ICdBcnJvd1VwJyxcbiAgQXJyb3dEb3duOiAnQXJyb3dEb3duJyxcbiAgQXJyb3dMZWZ0OiAnQXJyb3dMZWZ0JyxcbiAgQXJyb3dSaWdodDogJ0Fycm93UmlnaHQnLFxufVxuXG4vKipcbiAqIEtleWJvYXJkIG9wdGlvbnNcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEtleWJvYXJkT3B0aW9uc1xuICogQHByb3BlcnR5IHtib29sZWFufSBbY3RybEtleV0gLSBjb250cm9sIGtleSBpcyBwcmVzc2VkLlxuICogQHByb3BlcnR5IHtib29sZWFufSBbc2hpZnRLZXldIC0gc2hpZnQga2V5IGlzIHByZXNzZWQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFthbHRLZXldIC0gYWx0IGtleSBpcyBwcmVzc2VkLlxuICovXG5cbi8qKlxuICogZGV0ZXJtaW5lIHdoZXRoZXIgYSBudW1iZXIgaXMgcHJlc3NlZFxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldiBcbiAqIEBwYXJhbSB7bnVtYmVyfSBudW0gXG4gKiBAcGFyYW0ge0tleWJvYXJkT3B0aW9uc30gW29wdHNdXG4gKiBAcmV0dXJucyBib29sZWFuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc051bWJlclByZXNzZWQoZXYsIG51bSwgb3B0cyA9IHt9KSB7XG4gIGlmICghYXJlT3B0aW9uc1NhdGlzZmllZChldiwgb3B0cykpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIGZpbmROdW1iZXJQcmVzc2VkKGV2KSA9PT0gbnVtO1xufVxuXG4vKipcbiAqIGRldGVybWluZSB3aGV0aGVyIGEgY2hhciBpcyBwcmVzc2VkXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2IFxuICogQHBhcmFtIHtzdHJpbmd9IGNoYXJcbiAqIEBwYXJhbSB7S2V5Ym9hcmRPcHRpb25zfSBbb3B0c11cbiAqIEByZXR1cm5zIGJvb2xlYW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hhclByZXNzZWQoZXYsIGNoYXIsIG9wdHMgPSB7fSkge1xuICBpZiAoIWFyZU9wdGlvbnNTYXRpc2ZpZWQoZXYsIG9wdHMpKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBmaW5kQ2hhclByZXNzZWQoZXYpID09PSBjaGFyO1xufVxuXG4vKipcbiAqIERldGVybWluZSB3aGV0aGVyIG9wdGlvbnMgYXJlIHNhdGlzZmllZCAoY3RybCwgYWx0LCBzaGlmdCwgZXRjLilcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXYgXG4gKiBAcGFyYW0ge0tleWJvYXJkT3B0aW9uc30gW29wdHNdXG4gKiBAcmV0dXJucyBib29sZWFuXG4gKi9cbmZ1bmN0aW9uIGFyZU9wdGlvbnNTYXRpc2ZpZWQoZXYsIG9wdHMgPSB7fSkge1xuICBpZiAoIWV2KSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IGlzQ29udHJvbFByZXNzZWQgPSBldi5tZXRhS2V5IHx8IGV2LmN0cmxLZXk7IC8vIG1ldGEga2V5IGlzIENNRCBrZXkgb24gbWFjXG4gIGNvbnN0IGlzU2hpZnRQcmVzc2VkID0gZXYuc2hpZnRLZXk7XG4gIGNvbnN0IGlzQWx0S2V5UHJlc3NlZCA9IGV2LmFsdEtleTtcbiAgaWYgKG9wdHMuY3RybEtleSAmJiAhaXNDb250cm9sUHJlc3NlZCkgcmV0dXJuIGZhbHNlO1xuICBpZiAob3B0cy5zaGlmdEtleSAmJiAhaXNTaGlmdFByZXNzZWQpIHJldHVybiBmYWxzZTtcbiAgaWYgKG9wdHMuYWx0S2V5ICYmICFpc0FsdEtleVByZXNzZWQpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogRmluZCBudW1iZXIgcHJlc3NlZCwgb3IgLTEgaWYgbm8gbWF0Y2ggZm91bmRcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqIEByZXR1cm5zIG51bWJlclxuICovXG5leHBvcnQgZnVuY3Rpb24gZmluZE51bWJlclByZXNzZWQoZXYpIHtcbiAgaWYgKGV2LmtleSA9PT0gJzAnIHx8IGV2LmNvZGUgPT09ICdEaWdpdDAnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQwJyB8fCBldi5rZXlDb2RlID09PSA0OCB8fCBldi5rZXlDb2RlID09PSA5NikgcmV0dXJuIDA7XG4gIGlmIChldi5rZXkgPT09ICcxJyB8fCBldi5jb2RlID09PSAnRGlnaXQxJyB8fCBldi5jb2RlID09PSAnTnVtcGFkMScgfHwgZXYua2V5Q29kZSA9PT0gNDkgfHwgZXYua2V5Q29kZSA9PT0gOTcpIHJldHVybiAxO1xuICBpZiAoZXYua2V5ID09PSAnMicgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0MicgfHwgZXYuY29kZSA9PT0gJ051bXBhZDInIHx8IGV2LmtleUNvZGUgPT09IDUwIHx8IGV2LmtleUNvZGUgPT09IDk4KSByZXR1cm4gMjtcbiAgaWYgKGV2LmtleSA9PT0gJzMnIHx8IGV2LmNvZGUgPT09ICdEaWdpdDMnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQzJyB8fCBldi5rZXlDb2RlID09PSA1MSB8fCBldi5rZXlDb2RlID09PSA5OSkgcmV0dXJuIDM7XG4gIGlmIChldi5rZXkgPT09ICc0JyB8fCBldi5jb2RlID09PSAnRGlnaXQ0JyB8fCBldi5jb2RlID09PSAnTnVtcGFkNCcgfHwgZXYua2V5Q29kZSA9PT0gNTIgfHwgZXYua2V5Q29kZSA9PT0gMTAwKSByZXR1cm4gNDtcbiAgaWYgKGV2LmtleSA9PT0gJzUnIHx8IGV2LmNvZGUgPT09ICdEaWdpdDUnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQ1JyB8fCBldi5rZXlDb2RlID09PSA1MyB8fCBldi5rZXlDb2RlID09PSAxMDEpIHJldHVybiA1O1xuICBpZiAoZXYua2V5ID09PSAnNicgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0NicgfHwgZXYuY29kZSA9PT0gJ051bXBhZDYnIHx8IGV2LmtleUNvZGUgPT09IDU0IHx8IGV2LmtleUNvZGUgPT09IDEwMikgcmV0dXJuIDY7XG4gIGlmIChldi5rZXkgPT09ICc3JyB8fCBldi5jb2RlID09PSAnRGlnaXQ3JyB8fCBldi5jb2RlID09PSAnTnVtcGFkNycgfHwgZXYua2V5Q29kZSA9PT0gNTUgfHwgZXYua2V5Q29kZSA9PT0gMTAzKSByZXR1cm4gNztcbiAgaWYgKGV2LmtleSA9PT0gJzgnIHx8IGV2LmNvZGUgPT09ICdEaWdpdDgnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQ4JyB8fCBldi5rZXlDb2RlID09PSA1NiB8fCBldi5rZXlDb2RlID09PSAxMDQpIHJldHVybiA4O1xuICBpZiAoZXYua2V5ID09PSAnOScgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0OScgfHwgZXYuY29kZSA9PT0gJ051bXBhZDknIHx8IGV2LmtleUNvZGUgPT09IDU3IHx8IGV2LmtleUNvZGUgPT09IDEwNSkgcmV0dXJuIDk7XG4gIHJldHVybiAtMTtcbn1cblxuLyoqXG4gKiBGaW5kIGNoYXIgcHJlc3NlZCwgb3IgXCJcIiBpZiBubyBtYXRjaCBmb3VuZFxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldlxuICogQHJldHVybnMgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIGZpbmRDaGFyUHJlc3NlZChldikge1xuICBjb25zdCBudW0gPSBmaW5kTnVtYmVyUHJlc3NlZChldik7XG4gIGlmIChudW0gIT09IC0xKSByZXR1cm4gU3RyaW5nKG51bSk7XG4gIGlmIChldi5rZXkgPT09ICdhJyB8fCBldi5jb2RlID09PSAnS2V5QScgfHwgZXYua2V5Q29kZSA9PT0gNjUpIHJldHVybiAnYSc7XG4gIGlmIChldi5rZXkgPT09ICdiJyB8fCBldi5jb2RlID09PSAnS2V5QicgfHwgZXYua2V5Q29kZSA9PT0gNjYpIHJldHVybiAnYic7XG4gIGlmIChldi5rZXkgPT09ICdjJyB8fCBldi5jb2RlID09PSAnS2V5QycgfHwgZXYua2V5Q29kZSA9PT0gNjcpIHJldHVybiAnYyc7XG4gIGlmIChldi5rZXkgPT09ICdkJyB8fCBldi5jb2RlID09PSAnS2V5RCcgfHwgZXYua2V5Q29kZSA9PT0gNjgpIHJldHVybiAnZCc7XG4gIGlmIChldi5rZXkgPT09ICdlJyB8fCBldi5jb2RlID09PSAnS2V5RScgfHwgZXYua2V5Q29kZSA9PT0gNjkpIHJldHVybiAnZSc7XG4gIGlmIChldi5rZXkgPT09ICdmJyB8fCBldi5jb2RlID09PSAnS2V5RicgfHwgZXYua2V5Q29kZSA9PT0gNzApIHJldHVybiAnZic7XG4gIGlmIChldi5rZXkgPT09ICdnJyB8fCBldi5jb2RlID09PSAnS2V5RycgfHwgZXYua2V5Q29kZSA9PT0gNzEpIHJldHVybiAnZyc7XG4gIGlmIChldi5rZXkgPT09ICdoJyB8fCBldi5jb2RlID09PSAnS2V5SCcgfHwgZXYua2V5Q29kZSA9PT0gNzIpIHJldHVybiAnaCc7XG4gIGlmIChldi5rZXkgPT09ICdpJyB8fCBldi5jb2RlID09PSAnS2V5SScgfHwgZXYua2V5Q29kZSA9PT0gNzMpIHJldHVybiAnaSc7XG4gIGlmIChldi5rZXkgPT09ICdqJyB8fCBldi5jb2RlID09PSAnS2V5SicgfHwgZXYua2V5Q29kZSA9PT0gNzQpIHJldHVybiAnaic7XG4gIGlmIChldi5rZXkgPT09ICdrJyB8fCBldi5jb2RlID09PSAnS2V5SycgfHwgZXYua2V5Q29kZSA9PT0gNzUpIHJldHVybiAnayc7XG4gIGlmIChldi5rZXkgPT09ICdsJyB8fCBldi5jb2RlID09PSAnS2V5TCcgfHwgZXYua2V5Q29kZSA9PT0gNzYpIHJldHVybiAnbCc7XG4gIGlmIChldi5rZXkgPT09ICdtJyB8fCBldi5jb2RlID09PSAnS2V5TScgfHwgZXYua2V5Q29kZSA9PT0gNzcpIHJldHVybiAnbSc7XG4gIGlmIChldi5rZXkgPT09ICduJyB8fCBldi5jb2RlID09PSAnS2V5TicgfHwgZXYua2V5Q29kZSA9PT0gNzgpIHJldHVybiAnbic7XG4gIGlmIChldi5rZXkgPT09ICdvJyB8fCBldi5jb2RlID09PSAnS2V5TycgfHwgZXYua2V5Q29kZSA9PT0gNzkpIHJldHVybiAnbyc7XG4gIGlmIChldi5rZXkgPT09ICdwJyB8fCBldi5jb2RlID09PSAnS2V5UCcgfHwgZXYua2V5Q29kZSA9PT0gODApIHJldHVybiAncCc7XG4gIGlmIChldi5rZXkgPT09ICdxJyB8fCBldi5jb2RlID09PSAnS2V5UScgfHwgZXYua2V5Q29kZSA9PT0gODEpIHJldHVybiAncSc7XG4gIGlmIChldi5rZXkgPT09ICdyJyB8fCBldi5jb2RlID09PSAnS2V5UicgfHwgZXYua2V5Q29kZSA9PT0gODIpIHJldHVybiAncic7XG4gIGlmIChldi5rZXkgPT09ICdzJyB8fCBldi5jb2RlID09PSAnS2V5UycgfHwgZXYua2V5Q29kZSA9PT0gODMpIHJldHVybiAncyc7XG4gIGlmIChldi5rZXkgPT09ICd0JyB8fCBldi5jb2RlID09PSAnS2V5VCcgfHwgZXYua2V5Q29kZSA9PT0gODQpIHJldHVybiAndCc7XG4gIGlmIChldi5rZXkgPT09ICd1JyB8fCBldi5jb2RlID09PSAnS2V5VScgfHwgZXYua2V5Q29kZSA9PT0gODUpIHJldHVybiAndSc7XG4gIGlmIChldi5rZXkgPT09ICd2JyB8fCBldi5jb2RlID09PSAnS2V5VicgfHwgZXYua2V5Q29kZSA9PT0gODYpIHJldHVybiAndic7XG4gIGlmIChldi5rZXkgPT09ICd3JyB8fCBldi5jb2RlID09PSAnS2V5VycgfHwgZXYua2V5Q29kZSA9PT0gODcpIHJldHVybiAndyc7XG4gIGlmIChldi5rZXkgPT09ICd4JyB8fCBldi5jb2RlID09PSAnS2V5WCcgfHwgZXYua2V5Q29kZSA9PT0gODgpIHJldHVybiAneCc7XG4gIGlmIChldi5rZXkgPT09ICd5JyB8fCBldi5jb2RlID09PSAnS2V5WScgfHwgZXYua2V5Q29kZSA9PT0gODkpIHJldHVybiAneSc7XG4gIGlmIChldi5rZXkgPT09ICd6JyB8fCBldi5jb2RlID09PSAnS2V5WicgfHwgZXYua2V5Q29kZSA9PT0gOTApIHJldHVybiAneic7XG4gIGlmIChldi5rZXkgPT09ICdgJyB8fCBldi5jb2RlID09PSAnQmFja3F1b3RlJyB8fCBldi5rZXlDb2RlID09PSAxOTIpIHJldHVybiAnYCc7XG4gIGlmIChldi5rZXkgPT09ICctJyB8fCBldi5jb2RlID09PSAnTWludXMnIHx8IGV2LmtleUNvZGUgPT09IDE4OSkgcmV0dXJuICctJztcbiAgaWYgKGV2LmtleSA9PT0gJz0nIHx8IGV2LmNvZGUgPT09ICdFcXVhbHMnIHx8IGV2LmtleUNvZGUgPT09IDE4NykgcmV0dXJuICc9JztcbiAgaWYgKGV2LmtleSA9PT0gJy0nIHx8IGV2LmNvZGUgPT09ICdOdW1wYWRTdWJ0cmFjdCcgfHwgZXYua2V5Q29kZSA9PT0gMTA5KSByZXR1cm4gJy0nO1xuICBpZiAoZXYua2V5ID09PSAnKycgfHwgZXYuY29kZSA9PT0gJ051bXBhZEFkZCcgfHwgZXYua2V5Q29kZSA9PT0gMTA3KSByZXR1cm4gJysnO1xuICBpZiAoZXYua2V5ID09PSAnWycgfHwgZXYuY29kZSA9PT0gJ0JyYWNrZXRMZWZ0JyB8fCBldi5rZXlDb2RlID09PSAyMTkpIHJldHVybiAnWyc7XG4gIGlmIChldi5rZXkgPT09ICddJyB8fCBldi5jb2RlID09PSAnQnJhY2tldFJpZ2h0JyB8fCBldi5rZXlDb2RlID09PSAyMjEpIHJldHVybiAnXSc7XG4gIGlmIChldi5rZXkgPT09ICdCYWNrc3BhY2UnIHx8IGV2LmNvZGUgPT09ICdCYWNrc3BhY2UnIHx8IGV2LmtleUNvZGUgPT09IDIyMSkgcmV0dXJuIFNwZWNpYWxLZXkuQmFja3NwYWNlO1xuICBpZiAoZXYua2V5ID09PSAnRXNjYXBlJyB8fCBldi5jb2RlID09PSAnRXNjYXBlJyB8fCBldi5rZXlDb2RlID09PSAyNykgcmV0dXJuIFNwZWNpYWxLZXkuRXNjYXBlO1xuICBpZiAoZXYua2V5ID09PSAnICcgfHwgZXYuY29kZSA9PT0gJ1NwYWNlJyB8fCBldi5rZXlDb2RlID09PSAzMikgcmV0dXJuIFNwZWNpYWxLZXkuU3BhY2U7XG4gIGlmIChldi5rZXkgPT09ICdFbnRlcicgfHwgZXYuY29kZSA9PT0gJ0VudGVyJyB8fCBldi5jb2RlID09PSAnTnVtcGFkRW50ZXInIHx8IGV2LmtleUNvZGUgPT09IDEzKSByZXR1cm4gU3BlY2lhbEtleS5FbnRlcjtcbiAgaWYgKGV2LmtleSA9PT0gJ0RlbGV0ZScgfHwgZXYuY29kZSA9PT0gJ0RlbGV0ZScgfHwgZXYua2V5Q29kZSA9PT0gNDYpIHJldHVybiBTcGVjaWFsS2V5LkRlbGV0ZTtcbiAgaWYgKGV2LmtleSA9PT0gJ0Fycm93VXAnIHx8IGV2LmNvZGUgPT09ICdBcnJvd1VwJyB8fCBldi5rZXlDb2RlID09PSAzOCkgcmV0dXJuIFNwZWNpYWxLZXkuQXJyb3dVcDtcbiAgaWYgKGV2LmtleSA9PT0gJ0Fycm93RG93bicgfHwgZXYuY29kZSA9PT0gJ0Fycm93RG93bicgfHwgZXYua2V5Q29kZSA9PT0gNDApIHJldHVybiBTcGVjaWFsS2V5LkFycm93RG93bjtcbiAgaWYgKGV2LmtleSA9PT0gJ0Fycm93TGVmdCcgfHwgZXYuY29kZSA9PT0gJ0Fycm93TGVmdCcgfHwgZXYua2V5Q29kZSA9PT0gMzcpIHJldHVybiBTcGVjaWFsS2V5LkFycm93TGVmdDtcbiAgaWYgKGV2LmtleSA9PT0gJ0Fycm93UmlnaHQnIHx8IGV2LmNvZGUgPT09ICdBcnJvd1JpZ2h0JyB8fCBldi5rZXlDb2RlID09PSAzOSkgcmV0dXJuIFNwZWNpYWxLZXkuQXJyb3dSaWdodDtcbiAgcmV0dXJuICcnXG59XG4iLCJpbXBvcnQgeyByZXF1aXJlQnlJZCB9IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBzeW50aCA9IHdpbmRvdy5zcGVlY2hTeW50aGVzaXM7XG5cbmNvbnN0IHNlbGVjdFZvaWNlID0gcmVxdWlyZUJ5SWQoXCJzZWxlY3Qtdm9pY2VcIilcblxubGV0IHZvaWNlcztcblxuZnVuY3Rpb24gcmVtb3ZlVm9pY2VPcHRpb25zKCkge1xuICBmb3IgKGNvbnN0IGNoaWxkIG9mIHNlbGVjdFZvaWNlLmNoaWxkcmVuKSB7XG4gICAgY2hpbGQucmVtb3ZlKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gbG9hZFZvaWNlcygpIHtcbiAgdm9pY2VzID0gc3ludGguZ2V0Vm9pY2VzKCk7XG4gIHJlbW92ZVZvaWNlT3B0aW9ucygpO1xuICBsZXQgY2hvc2VuVm9pY2VJbmRleCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdm9pY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKCEvXnB0LS8udGVzdCh2b2ljZXNbaV0ubGFuZykpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGAke3ZvaWNlc1tpXS5uYW1lfSAoJHt2b2ljZXNbaV0ubGFuZ30pYDtcbiAgICBvcHRpb24udmFsdWUgPSBpO1xuICAgIHNlbGVjdFZvaWNlLmFwcGVuZENoaWxkKG9wdGlvbik7XG4gICAgaWYgKCFjaG9zZW5Wb2ljZUluZGV4ICYmIHZvaWNlc1tpXS5sYW5nID09PSAncHQtQlInICYmIHZvaWNlc1tpXS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2dvb2dsZScpKSB7XG4gICAgICBjaG9zZW5Wb2ljZUluZGV4ID0gaTtcbiAgICB9XG4gIH1cbiAgc2VsZWN0Vm9pY2UudmFsdWUgPSBjaG9zZW5Wb2ljZUluZGV4O1xufVxuXG4vLyBpbiBHb29nbGUgQ2hyb21lIHRoZSB2b2ljZXMgYXJlIG5vdCByZWFkeSBvbiBwYWdlIGxvYWRcbmlmIChcIm9udm9pY2VzY2hhbmdlZFwiIGluIHN5bnRoKSB7XG4gIHN5bnRoLm9udm9pY2VzY2hhbmdlZCA9IGxvYWRWb2ljZXM7XG59IGVsc2Uge1xuICBsb2FkVm9pY2VzKCk7XG59XG5cbmV4cG9ydCBjb25zdCBzcGVhayA9ICh0ZXh0KSA9PiB7XG4gIGNvbnN0IGZpbHRlcmVkID0gdGV4dC5yZXBsYWNlKC9cXCpcXCovZywgJycpO1xuICBjb25zdCB1dHRlcmFuY2UgPSBuZXcgU3BlZWNoU3ludGhlc2lzVXR0ZXJhbmNlKGZpbHRlcmVkKTtcbiAgdXR0ZXJhbmNlLnZvaWNlID0gdm9pY2VzW3NlbGVjdFZvaWNlLnZhbHVlXTtcbiAgc3ludGguc3BlYWsodXR0ZXJhbmNlKTtcbn1cbiIsIlxuZXhwb3J0IGNsYXNzIEJhc2VTdG9yZSB7XG4gIGdldCBrZXkoKSB7fSAvLyBhYnN0cmFjdFxuXG4gIGNsZWFyU3RvcmUgPSAoKSA9PiB7XG4gICAgdGhpcy5fdmFsaWRhdGUoKTtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLmtleSk7XG4gIH1cblxuICBnZXRTdG9yZSA9ICgpID0+IHtcbiAgICB0aGlzLl92YWxpZGF0ZSgpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpdGVtUmF3ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5rZXkpO1xuICAgICAgaWYgKCFpdGVtUmF3KSByZXR1cm4gbnVsbDtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGl0ZW1SYXcpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oZXJyKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHNldFN0b3JlID0gKHZhbHVlKSA9PiB7XG4gICAgdGhpcy5fdmFsaWRhdGUoKTtcbiAgICB0cnkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5rZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSlcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUud2FybihlcnIpO1xuICAgIH1cbiAgfVxuXG4gIF92YWxpZGF0ZSA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMua2V5KSB0aHJvdyBuZXcgRXJyb3IoJ2xvY2FsIHN0b3JhZ2Uga2V5IGlzIHJlcXVpcmVkJyk7XG4gIH1cbn0iLCJpbXBvcnQgeyBCYXNlU3RvcmUgfSBmcm9tIFwiLi9CYXNlU3RvcmVcIjtcbmltcG9ydCB7IEVYRVJDSVNFLCBPUkRFUiB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcblxuY2xhc3MgT3B0aW9uc1N0b3JlIGV4dGVuZHMgQmFzZVN0b3JlIHtcbiAgZ2V0IGtleSgpIHtcbiAgICByZXR1cm4gXCJwdC1vcHRpb25zXCJcbiAgfVxuXG4gIF9kZWZhdWx0VmFsdWUgPSB7XG4gICAgb3JkZXI6IE9SREVSLkFOWSxcbiAgICBzZWxlY3RlZEV4ZXJjaXNlczoge1xuICAgICAgW0VYRVJDSVNFLlZFUl9DT05KQVRJT05dOiB0cnVlLFxuICAgICAgW0VYRVJDSVNFLlZJUl9DT05KVUdBVElPTl06IHRydWUsXG4gICAgICBbRVhFUkNJU0UuV0VBS19QSFJBU0VTXTogdHJ1ZSxcbiAgICB9LFxuICB9O1xuXG4gIF9zdGF0ZSA9IHRoaXMuZ2V0U3RvcmUoKSB8fCB7IC4uLnRoaXMuX2RlZmF1bHRWYWx1ZSB9O1xuXG4gIC8qKlxuICAgKiBAcmV0dXJucyBzdHJpbmdcbiAgICovXG4gIGdldE9yZGVyID0gKCkgPT4gdGhpcy5fc3RhdGUub3JkZXI7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YWxcbiAgICovXG4gIHNldE9yZGVyID0gKHZhbCkgPT4ge1xuICAgIHRoaXMuX3N0YXRlLm9yZGVyID0gdmFsO1xuICAgIHRoaXMuc2V0U3RvcmUodGhpcy5fc3RhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIG9iamVjdFxuICAgKi9cbiAgZ2V0U2VsZWN0ZWRFeGVyY2lzZXMgPSAoKSA9PiAoeyAuLi50aGlzLl9zdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlcyB9KTtcblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV4ZXJjaXNlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZWxlY3RlZFxuICAgKi9cbiAgc2V0U2VsZWN0ZWRFeGVyY2lzZSA9IChleGVyY2lzZSwgaXNTZWxlY3RlZCkgPT4ge1xuICAgIHRoaXMuX3N0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW2V4ZXJjaXNlXSA9IGlzU2VsZWN0ZWQ7XG4gICAgdGhpcy5zZXRTdG9yZSh0aGlzLl9zdGF0ZSk7XG4gIH1cblxuICByZXNldCA9ICgpID0+IHtcbiAgICB0aGlzLmNsZWFyU3RvcmUoKTtcbiAgICB0aGlzLl9zdGF0ZSA9IHsgLi4udGhpcy5fZGVmYXVsdFZhbHVlIH07XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IG9wdGlvbnNTdG9yZSA9IG5ldyBPcHRpb25zU3RvcmUoKTtcbiIsImltcG9ydCB7IEJhc2VTdG9yZSB9IGZyb20gXCIuL0Jhc2VTdG9yZVwiO1xuXG5jbGFzcyBRdWVzdGlvbnNTdG9yZSBleHRlbmRzIEJhc2VTdG9yZSB7XG4gIGdldCBrZXkoKSB7XG4gICAgcmV0dXJuIFwicHQtcXVlc3Rpb25zXCJcbiAgfVxuXG4gIC8qKlxuICAgKiBTbm9vemVkID0ga2V5LXZhbHVlIHBhaXJzIG9mIGhhc2hlZCBwb3J0dWd1ZXNlIHBocmFzZSAoc2hhMjU2KSwgYW5kIHRpbWVTbm9vemVFeHBpcmVzTXNcbiAgICogYGBgc25vb3plZDogUmVjb3JkPHN0cmluZywgbnVtYmVyPmBgYFxuICAgKi9cbiAgX2RlZmF1bHRWYWx1ZSA9IHtcbiAgICBzbm9vemVkOiB7fSxcbiAgfTtcblxuICBfc3RhdGUgPSB0aGlzLmdldFN0b3JlKCkgfHwgeyAuLi50aGlzLl9kZWZhdWx0VmFsdWUgfTtcblxuICBnZXRTbm9vemVkUXVlc3Rpb25zID0gKCkgPT4gKHsgLi4udGhpcy5fc3RhdGUuc25vb3plZCB9KTtcblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGhhc2hcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNub296ZUR1cmF0aW9uTXNcbiAgICovXG4gIHNub296ZVF1ZXN0aW9uID0gKGhhc2gsIHNub296ZUR1cmF0aW9uTXMpID0+IHtcbiAgICBpZiAoIWhhc2gpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCB0aW1lU25vb3plRXhwaXJlc01zID0gbm93ICsgc25vb3plRHVyYXRpb25NcztcbiAgICB0aGlzLl9zdGF0ZS5zbm9vemVkW2hhc2hdID0gdGltZVNub296ZUV4cGlyZXNNcztcbiAgICB0aGlzLnNldFN0b3JlKHRoaXMuX3N0YXRlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJlc2V0ID0gKCkgPT4ge1xuICAgIHRoaXMuY2xlYXJTdG9yZSgpO1xuICAgIHRoaXMuX3N0YXRlID0geyAuLi50aGlzLl9kZWZhdWx0VmFsdWUgfTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcXVlc3Rpb25zU3RvcmUgPSBuZXcgUXVlc3Rpb25zU3RvcmUoKTtcblxuIiwiXG5leHBvcnQgZnVuY3Rpb24gc2h1ZmZsZUFycmF5KGFycmF5KSB7XG4gIGNvbnN0IGNvcHkgPSBhcnJheS5zbGljZSgpXG4gIGZvciAobGV0IGkgPSBjb3B5Lmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICBjb25zdCBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgY29uc3QgdGVtcCA9IGNvcHlbaV07XG4gICAgY29weVtpXSA9IGNvcHlbal07XG4gICAgY29weVtqXSA9IHRlbXA7XG4gIH1cbiAgcmV0dXJuIGNvcHk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBvcHRUZXh0KSB7XG4gIGNvbnN0IHJlc3VsdCA9IHR5cGVvZiBjb25kaXRpb24gPT09ICdmdW5jdGlvbicgPyBjb25kaXRpb24oKSA6IGNvbmRpdGlvblxuICBpZiAoIXJlc3VsdCkge1xuICAgIHRocm93IG5ldyBFcnJvcihvcHRUZXh0IHx8ICdBc3NlcnRpb24gRmFpbGVkIScpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlQnlJZChpZCkge1xuICBjb25zdCBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICBpZiAoIWVsZW0pIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgRE9NIGVsZW1lbnQgd2l0aCBpZCBcIiR7aWR9XCIhIWApO1xuICByZXR1cm4gZWxlbTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFycmF5RWxlbWVudChpdGVtcywgaW5kZXggPSAtMSkge1xuICBpZiAoaW5kZXggPCAwKSByZXR1cm4gaXRlbXM7XG4gIGlmIChpbmRleCA+PSBpdGVtcy5sZW5ndGgpIHJldHVybiBpdGVtcztcbiAgcmV0dXJuIGl0ZW1zLnNsaWNlKDAsIGluZGV4KS5jb25jYXQoaXRlbXMuc2xpY2UoaW5kZXggKyAxKSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNoYTI1NihtZXNzYWdlID0gJycpIHtcbiAgY29uc3QgbXNnVWludDggPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUobWVzc2FnZSk7IC8vIGVuY29kZSBhcyAodXRmLTgpIFVpbnQ4QXJyYXlcbiAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IHdpbmRvdy5jcnlwdG8uc3VidGxlLmRpZ2VzdChcIlNIQS0yNTZcIiwgbXNnVWludDgpOyAvLyBoYXNoIHRoZSBtZXNzYWdlXG4gIGNvbnN0IGhhc2hBcnJheSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoaGFzaEJ1ZmZlcikpOyAvLyBjb252ZXJ0IGJ1ZmZlciB0byBieXRlIGFycmF5XG4gIGNvbnN0IGhhc2hIZXggPSBoYXNoQXJyYXlcbiAgICAubWFwKChiKSA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCBcIjBcIikpXG4gICAgLmpvaW4oXCJcIik7IC8vIGNvbnZlcnQgYnl0ZXMgdG8gaGV4IHN0cmluZ1xuICByZXR1cm4gaGFzaEhleDtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0ICcuL2FwcCdcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==