/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/resources/conjugation-ver-vir.yaml":
/*!************************************************!*\
  !*** ./src/resources/conjugation-ver-vir.yaml ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({ver:{present:[{pr:'eu vejo o sol todos os dias',en:'I see the sun every day'},{pr:'ele vê os pássaros voando',en:'he sees the birds flying'},{pr:'nós vemos o mar daqui',en:'we see the sea from here'},{pr:'eles veem os animais na floresta',en:'the see the animals in the forest'}],imperfect:[{pr:'eu via os carros passarem na rua',en:'I used to see the cars passing in the road'},{pr:'ele via os animais na floresta',en:'he used to see the animals in the forest'},{pr:'nós víamos o pôr do sol na praia',en:'we used to see the sunset on the beach'},{pr:'eles viam a lua no céu',en:'they used to see the moon in the sky'}],preterite:[{pr:'eu vi o filme ontem',en:'I saw the film yesterday'},{pr:'ele viu o trem passar',en:'he saw the train pass'},{pr:'nós vimos o mar agitado',en:'we saw the rough sea'},{pr:'eles viram o eclipse da lua',en:'they saw the eclipse of the moon'}],presentPerfect:[{pr:'eu tenho visto muitos filmes bons',en:'I have seen many good films'},{pr:'ele tem visto muitas estrelas à noite',en:'he has seen many stars at night'},{pr:'nós temos visto o pôr do sol juntos',en:'we have seen the sunset together'},{pr:'eles têm visto os fogos de artifício no céu',en:'they have seen the fireworks in the sky'}],future:[{pr:'eu verei o nascer do sol amanhã',en:'I will see the sunrise tomorrow'},{pr:'ele verá os fogos de artifício no reveillon',en:'He will see the fireworks on New Year\'s Eve'},{pr:'nós veremos o mar azul na viagem',en:'we will see the blue sea on the journey'},{pr:'eles verão as flores no jardim',en:'they will see the flowers in the garden'}]},vir:{present:[{pr:'eu venho sempre ao parque',en:'I always come to the park'},{pr:'ela vem mais tarde',en:'she comes later'},{pr:'nós vimos o filme juntos',en:'we see the film together'},{pr:'eles vêm de longe',en:'they come from afar'}],imperfect:[{pr:'eu vinha ao parque todos os dias',en:'I used to come to the park every day'},{pr:'ele vinha ler aqui à tarde',en:'he used to come read here in the afternoon'},{pr:'nós vinhamos sempre antes do jantar',en:'we used to always come before dinner'},{pr:'eles vinham jogar futebol todas as tardes',en:'they used to come play soccer every afternoon'}],preterite:[{pr:'eu vim à praia hoje',en:'I came to the beach today'},{pr:'ele veio ajudar a avó',en:'he came to help his granmother'},{pr:'nós viemos almoçar contigo',en:'we came to have lunch with you'},{pr:'eles vieram rápido demais',en:'they came too fast'}],presentPerfect:[{pr:'eu tehno vindo aqui com frequência',en:'I have been coming here often'},{pr:'ele tem vindo ajudar os outros',en:'he has been coming to help others'},{pr:'nós temos vindo passear no parque',en:'we have been coming for a walk in the park'},{pr:'eles têm vindo brincar no parque',en:'they have been coming to play in the park'}],future:[{pr:'eu virei buscar você mais tarde',en:'I will come find you later'},{pr:'ele virá ajudar na festa',en:'he will come help at the party'},{pr:'nós viremos jantar juntos',en:'we will come to dinner together'},{pr:'eles virão no próximo final de semana',en:'they will come next weekend'}]}});

/***/ }),

/***/ "./src/resources/weak-phrases.yaml":
/*!*****************************************!*\
  !*** ./src/resources/weak-phrases.yaml ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ([{pr:'Ele é um colecionador que coleciona itens',en:'He is a collector who collects items'},{pr:'Tenho uma coleção',en:'I have a collection'},{pr:'Vou **ganhar** mais dinheiro naquela hora',en:'I will **get** more money at that time'},{pr:'Foi escuro lá fora',en:'It was dark outside'},{pr:'Está ficando oscuro lá fora',en:'It is getting dark outside'},{pr:'Venha me conhecer algum dia',en:'Come and meet me some day'},{pr:'Venha me ver algum dia',en:'Come and see me some day'},{pr:'Não perca a fé',en:'Do not lose faith'},{pr:'He does not lose faith',en:'Ele não perde a fé'},{pr:'Ela me apresentou ao seu namorado na festa',en:'She introduced me to her boyfriend at the party'},{pr:'Ele levou meu casaco',en:'He took my coat'},{pr:'Eu te dou este relógio como um presente',en:'I give this watch to you as a gift'},{pr:'Eu sonhei um sonho de um tempo passado',en:'I dreamed a dream of time gone by'},{pr:'Eu me diverti muito',en:'I had a good time'},{pr:'Foi um bom momento',en:'It was a good time'},{pr:'Ele veio de longe',en:'He came from far away'},{pr:'Estou vindo',en:'I am coming'},{pr:'Continue em frente, por favor',en:'Keep going forward, please'},{pr:'A luz é brilhante',en:'The light is bright'},{pr:'É favorável para nós irmos',en:'It is favorable for us to go'},{pr:'Eu pensei que nosso **compromisso** seria na semana que vem',en:'I thought that our **meeting** was next week'},{pr:'Isso não quer dizer nada',en:'This doesn\'t mean anything'},{pr:'Eles me **dão** arroz',en:'They **give** me rice'},{pr:'Ele não deve vir aqui novamente',en:'He must not come here again'},{pr:'Há outros fatores que nos fazem pensar assim',en:'There are other factors that make us think like that'},{pr:'Ela nos explora',en:'She exploits us'},{pr:'O restaurante fica em frente à escola',en:'The restaurant is in front of the school'},{pr:'Este é meu tipo de personagem',en:'This is my type of character'},{pr:'Eu não vejo minha namorada há duas semanas',en:'I have not seen my girlfriend for two weeks'},{pr:'Como tem passado o seu pai?',en:'How has your father been?'},{pr:'Meu filho tem me perguntado **coisas estranhas**',en:'My son has been asking me **strange questions**'},{pr:'Tente descobrir se tudo que ele disse é verdade',en:'Try to find out if everything that he said is true'},{pr:'Ele me conta tudo',en:'He tells me everything'},{pr:'Eu segurei um bebé em meus braços',en:'I held a baby in my arms'}]);

/***/ }),

/***/ "./src/constants.js":
/*!**************************!*\
  !*** ./src/constants.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EXERCISE: () => (/* binding */ EXERCISE),
/* harmony export */   ORDER: () => (/* binding */ ORDER)
/* harmony export */ });

const ORDER = {
  PR_FIRST: 'pr-first',
  EN_FIRST: 'en-first',
  ANY: 'any',
}

const EXERCISE = {
  VER_CONJATION: 'checkbox-exercise-ver-conjugation',
  VIR_CONJUGATION: 'checkbox-exercise-vir-conjugation',
  WEAK_PHRASES: 'checkbox-exercise-weak-phrases',
}


/***/ }),

/***/ "./src/keyboardUtils.js":
/*!******************************!*\
  !*** ./src/keyboardUtils.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SpecialKey: () => (/* binding */ SpecialKey),
/* harmony export */   findNumberPressed: () => (/* binding */ findNumberPressed),
/* harmony export */   isCharPressed: () => (/* binding */ isCharPressed),
/* harmony export */   isNumberPressed: () => (/* binding */ isNumberPressed)
/* harmony export */ });

const SpecialKey = {
  Backspace: 'backspace',
  Escape: 'escape',
  Tab: 'tab',
  Space: 'space',
  Enter: 'enter',
  Delete: 'delete',
  ArrowUp: 'ArrowUp',
  ArrowDown: 'ArrowDown',
  ArrowLeft: 'ArrowLeft',
  ArrowRight: 'ArrowRight',
}

/**
 * Keyboard options
 * @typedef {Object} KeyboardOptions
 * @property {boolean} [ctrlKey] - control key is pressed.
 * @property {boolean} [shiftKey] - shift key is pressed.
 * @property {boolean} [altKey] - alt key is pressed.
 */

/**
 * determine whether a number is pressed
 * @param {KeyboardEvent} ev 
 * @param {number} num 
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function isNumberPressed(ev, num, opts = {}) {
  if (!areOptionsSatisfied(ev, opts)) return false;
  return findNumberPressed(ev) === num;
}

/**
 * determine whether a char is pressed
 * @param {KeyboardEvent} ev 
 * @param {string} char
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function isCharPressed(ev, char, opts = {}) {
  if (!areOptionsSatisfied(ev, opts)) return false;
  return findCharPressed(ev) === char;
}

/**
 * Determine whether options are satisfied (ctrl, alt, shift, etc.)
 * @param {KeyboardEvent} ev 
 * @param {KeyboardOptions} [opts]
 * @returns boolean
 */
function areOptionsSatisfied(ev, opts = {}) {
  if (!ev) return false;
  const isControlPressed = ev.metaKey || ev.ctrlKey; // meta key is CMD key on mac
  const isShiftPressed = ev.shiftKey;
  const isAltKeyPressed = ev.altKey;
  if (opts.ctrlKey && !isControlPressed) return false;
  if (opts.shiftKey && !isShiftPressed) return false;
  if (opts.altKey && !isAltKeyPressed) return false;
  return true;
}

/**
 * Find number pressed, or -1 if no match found
 * @param {KeyboardEvent} ev
 * @returns number
 */
function findNumberPressed(ev) {
  if (ev.key === '0' || ev.code === 'Digit0' || ev.code === 'Numpad0' || ev.keyCode === 48 || ev.keyCode === 96) return 0;
  if (ev.key === '1' || ev.code === 'Digit1' || ev.code === 'Numpad1' || ev.keyCode === 49 || ev.keyCode === 97) return 1;
  if (ev.key === '2' || ev.code === 'Digit2' || ev.code === 'Numpad2' || ev.keyCode === 50 || ev.keyCode === 98) return 2;
  if (ev.key === '3' || ev.code === 'Digit3' || ev.code === 'Numpad3' || ev.keyCode === 51 || ev.keyCode === 99) return 3;
  if (ev.key === '4' || ev.code === 'Digit4' || ev.code === 'Numpad4' || ev.keyCode === 52 || ev.keyCode === 100) return 4;
  if (ev.key === '5' || ev.code === 'Digit5' || ev.code === 'Numpad5' || ev.keyCode === 53 || ev.keyCode === 101) return 5;
  if (ev.key === '6' || ev.code === 'Digit6' || ev.code === 'Numpad6' || ev.keyCode === 54 || ev.keyCode === 102) return 6;
  if (ev.key === '7' || ev.code === 'Digit7' || ev.code === 'Numpad7' || ev.keyCode === 55 || ev.keyCode === 103) return 7;
  if (ev.key === '8' || ev.code === 'Digit8' || ev.code === 'Numpad8' || ev.keyCode === 56 || ev.keyCode === 104) return 8;
  if (ev.key === '9' || ev.code === 'Digit9' || ev.code === 'Numpad9' || ev.keyCode === 57 || ev.keyCode === 105) return 9;
  return -1;
}

/**
 * Find char pressed, or "" if no match found
 * @param {KeyboardEvent} ev
 * @returns string
 */
function findCharPressed(ev) {
  const num = findNumberPressed(ev);
  if (num !== -1) return String(num);
  if (ev.key === 'a' || ev.code === 'KeyA' || ev.keyCode === 65) return 'a';
  if (ev.key === 'b' || ev.code === 'KeyB' || ev.keyCode === 66) return 'b';
  if (ev.key === 'c' || ev.code === 'KeyC' || ev.keyCode === 67) return 'c';
  if (ev.key === 'd' || ev.code === 'KeyD' || ev.keyCode === 68) return 'd';
  if (ev.key === 'e' || ev.code === 'KeyE' || ev.keyCode === 69) return 'e';
  if (ev.key === 'f' || ev.code === 'KeyF' || ev.keyCode === 70) return 'f';
  if (ev.key === 'g' || ev.code === 'KeyG' || ev.keyCode === 71) return 'g';
  if (ev.key === 'h' || ev.code === 'KeyH' || ev.keyCode === 72) return 'h';
  if (ev.key === 'i' || ev.code === 'KeyI' || ev.keyCode === 73) return 'i';
  if (ev.key === 'j' || ev.code === 'KeyJ' || ev.keyCode === 74) return 'j';
  if (ev.key === 'k' || ev.code === 'KeyK' || ev.keyCode === 75) return 'k';
  if (ev.key === 'l' || ev.code === 'KeyL' || ev.keyCode === 76) return 'l';
  if (ev.key === 'm' || ev.code === 'KeyM' || ev.keyCode === 77) return 'm';
  if (ev.key === 'n' || ev.code === 'KeyN' || ev.keyCode === 78) return 'n';
  if (ev.key === 'o' || ev.code === 'KeyO' || ev.keyCode === 79) return 'o';
  if (ev.key === 'p' || ev.code === 'KeyP' || ev.keyCode === 80) return 'p';
  if (ev.key === 'q' || ev.code === 'KeyQ' || ev.keyCode === 81) return 'q';
  if (ev.key === 'r' || ev.code === 'KeyR' || ev.keyCode === 82) return 'r';
  if (ev.key === 's' || ev.code === 'KeyS' || ev.keyCode === 83) return 's';
  if (ev.key === 't' || ev.code === 'KeyT' || ev.keyCode === 84) return 't';
  if (ev.key === 'u' || ev.code === 'KeyU' || ev.keyCode === 85) return 'u';
  if (ev.key === 'v' || ev.code === 'KeyV' || ev.keyCode === 86) return 'v';
  if (ev.key === 'w' || ev.code === 'KeyW' || ev.keyCode === 87) return 'w';
  if (ev.key === 'x' || ev.code === 'KeyX' || ev.keyCode === 88) return 'x';
  if (ev.key === 'y' || ev.code === 'KeyY' || ev.keyCode === 89) return 'y';
  if (ev.key === 'z' || ev.code === 'KeyZ' || ev.keyCode === 90) return 'z';
  if (ev.key === '`' || ev.code === 'Backquote' || ev.keyCode === 192) return '`';
  if (ev.key === '-' || ev.code === 'Minus' || ev.keyCode === 189) return '-';
  if (ev.key === '=' || ev.code === 'Equals' || ev.keyCode === 187) return '=';
  if (ev.key === '-' || ev.code === 'NumpadSubtract' || ev.keyCode === 109) return '-';
  if (ev.key === '+' || ev.code === 'NumpadAdd' || ev.keyCode === 107) return '+';
  if (ev.key === '[' || ev.code === 'BracketLeft' || ev.keyCode === 219) return '[';
  if (ev.key === ']' || ev.code === 'BracketRight' || ev.keyCode === 221) return ']';
  if (ev.key === 'Backspace' || ev.code === 'Backspace' || ev.keyCode === 221) return SpecialKey.Backspace;
  if (ev.key === 'Escape' || ev.code === 'Escape' || ev.keyCode === 27) return SpecialKey.Escape;
  if (ev.key === ' ' || ev.code === 'Space' || ev.keyCode === 32) return SpecialKey.Space;
  if (ev.key === 'Enter' || ev.code === 'Enter' || ev.code === 'NumpadEnter' || ev.keyCode === 13) return SpecialKey.Enter;
  if (ev.key === 'Delete' || ev.code === 'Delete' || ev.keyCode === 46) return SpecialKey.Delete;
  if (ev.key === 'ArrowUp' || ev.code === 'ArrowUp' || ev.keyCode === 38) return SpecialKey.ArrowUp;
  if (ev.key === 'ArrowDown' || ev.code === 'ArrowDown' || ev.keyCode === 40) return SpecialKey.ArrowDown;
  if (ev.key === 'ArrowLeft' || ev.code === 'ArrowLeft' || ev.keyCode === 37) return SpecialKey.ArrowLeft;
  if (ev.key === 'ArrowRight' || ev.code === 'ArrowRight' || ev.keyCode === 39) return SpecialKey.ArrowRight;
  return ''
}


/***/ }),

/***/ "./src/speak.js":
/*!**********************!*\
  !*** ./src/speak.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   speak: () => (/* binding */ speak)
/* harmony export */ });
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "./src/utils.js");


const synth = window.speechSynthesis;

const selectVoice = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.requireById)("select-voice")

let voices;

function removeVoiceOptions() {
  for (const child of selectVoice.children) {
    child.remove();
  }
}

function loadVoices() {
  voices = synth.getVoices();
  removeVoiceOptions();
  let chosenVoiceIndex = 0;
  for (let i = 0; i < voices.length; i++) {
    if (!/^pt-/.test(voices[i].lang)) {
      continue;
    }
    const option = document.createElement("option");
    option.textContent = `${voices[i].name} (${voices[i].lang})`;
    option.value = i;
    selectVoice.appendChild(option);
    if (voices[i].lang === 'pt-BR' && voices[i].name.toLowerCase().includes('google')) {
      chosenVoiceIndex = i;
    }
  }
  selectVoice.value = chosenVoiceIndex;
}

// in Google Chrome the voices are not ready on page load
if ("onvoiceschanged" in synth) {
  synth.onvoiceschanged = loadVoices;
} else {
  loadVoices();
}

const speak = (text) => {
  const filtered = text.replace(/\*\*/g, '');
  const utterance = new SpeechSynthesisUtterance(filtered);
  utterance.voice = voices[selectVoice.value];
  synth.speak(utterance);
}


/***/ }),

/***/ "./src/stores/BaseStore.js":
/*!*********************************!*\
  !*** ./src/stores/BaseStore.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BaseStore: () => (/* binding */ BaseStore)
/* harmony export */ });

class BaseStore {
  get key() {} // abstract

  clearStore = () => {
    this._validate();
    localStorage.removeItem(this.key);
  }

  getStore = () => {
    this._validate();
    try {
      const itemRaw = localStorage.getItem(this.key);
      if (!itemRaw) return null;
      return JSON.parse(itemRaw)
    } catch (err) {
      console.warn(err);
      return null;
    }
  }

  setStore = (value) => {
    this._validate();
    try {
      localStorage.setItem(this.key, JSON.stringify(value))
    } catch (err) {
      console.warn(err);
    }
  }

  _validate = () => {
    if (!this.key) throw new Error('local storage key is required');
  }
}

/***/ }),

/***/ "./src/stores/OptionsStore.js":
/*!************************************!*\
  !*** ./src/stores/OptionsStore.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   optionsStore: () => (/* binding */ optionsStore)
/* harmony export */ });
/* harmony import */ var _BaseStore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseStore */ "./src/stores/BaseStore.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./src/constants.js");



class OptionsStore extends _BaseStore__WEBPACK_IMPORTED_MODULE_0__.BaseStore {
  get key() {
    return "options-data"
  }

  _defaultValue = {
    order: _constants__WEBPACK_IMPORTED_MODULE_1__.ORDER.ANY,
    selectedExercises: {
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.VER_CONJATION]: true,
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.VIR_CONJUGATION]: true,
      [_constants__WEBPACK_IMPORTED_MODULE_1__.EXERCISE.WEAK_PHRASES]: true,
    },
  };

  _state = this.getStore() || { ...this._defaultValue };

  /**
   * @returns string
   */
  getOrder = () => this._state.order;

  /**
   * @param {string} val
   */
  setOrder = (val) => {
    this._state.order = val;
    this.setStore(this._state);
  }

  /**
   * @returns object
   */
  getSelectedExercises = () => this._state.selectedExercises;

  /**
   * @param {string} exercise
   * @param {boolean} isSelected
   */
  setSelectedExercise = (exercise, isSelected) => {
    this._state.selectedExercises[exercise] = isSelected;
    this.setStore(this._state);
  }

  reset = () => {
    this.clearStore();
    this._state = { ...this._defaultValue };
  }
}

const optionsStore = new OptionsStore();


/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   assert: () => (/* binding */ assert),
/* harmony export */   requireById: () => (/* binding */ requireById),
/* harmony export */   shuffleArray: () => (/* binding */ shuffleArray)
/* harmony export */ });

function shuffleArray(array) {
  const copy = array.slice()
  for (let i = copy.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    const temp = copy[i];
    copy[i] = copy[j];
    copy[j] = temp;
  }
  return copy;
}

function assert(condition, optText) {
  const result = typeof condition === 'function' ? condition() : condition
  if (!result) {
    throw new Error(optText || 'Assertion Failed!');
  }
}

function requireById(id) {
  const elem = document.getElementById(id);
  if (!elem) throw new Error(`Could not find DOM element with id "${id}"!!`);
  return elem;
}


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resources/conjugation-ver-vir.yaml */ "./src/resources/conjugation-ver-vir.yaml");
/* harmony import */ var _resources_weak_phrases_yaml__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resources/weak-phrases.yaml */ "./src/resources/weak-phrases.yaml");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants */ "./src/constants.js");
/* harmony import */ var _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./keyboardUtils */ "./src/keyboardUtils.js");
/* harmony import */ var _speak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./speak */ "./src/speak.js");
/* harmony import */ var _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./stores/OptionsStore */ "./src/stores/OptionsStore.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils */ "./src/utils.js");









const cardQuestion = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('card-question');
const cardAnswer = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('card-answer');
const cardQuestionContent = cardQuestion.children[0]
const cardAnswerContent = cardAnswer.children[0]

;(0,_utils__WEBPACK_IMPORTED_MODULE_6__.assert)(cardQuestionContent, 'cardQuestionContent does not exist');
(0,_utils__WEBPACK_IMPORTED_MODULE_6__.assert)(cardAnswerContent, 'cardAnswerContent does not exist');

const buttonPrev = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('button-prev');
const buttonNext = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('button-next');
const buttonReshuffle = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('button-reshuffle');
const buttonSpeak = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('button-speak');
const progress = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('progress');
const formQuestionOrder = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('form-question-order');
const formSelectExercises = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.requireById)('form-select-exercises');

const state = {
  revealed: false,
  problems: [], // array of tuples -> [question, answer, portuguese-index-for-text-to-speech][]
  index: 0,
  order: _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_5__.optionsStore.getOrder(),
  selectedExercises: _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_5__.optionsStore.getSelectedExercises(),
};

function main() {
  renderOptions();
  shuffleQuestions();
  setupListeners();
}

function randBool() {
  return Math.random() >= 0.5
}

function shuffleQuestions() {
  state.revealed = false;
  state.problems = [];
  state.index = 0;
  const problems = []
  const addProblem = (problem) => {
    if (!problem.en || !problem.pr) {
      throw new Error(`Problem is invalid: ${JSON.stringify(problem)}`)
    }
    if (state.order === _constants__WEBPACK_IMPORTED_MODULE_2__.ORDER.EN_FIRST) {
      problems.push([problem.en, problem.pr, 1]);
    } else if (state.order === _constants__WEBPACK_IMPORTED_MODULE_2__.ORDER.PR_FIRST) {
      problems.push([problem.pr, problem.en, 0]);
    } else {
      const flip = randBool();
      if (flip) {
        problems.push([problem.en, problem.pr, 1]);
      } else {
        problems.push([problem.pr, problem.en, 0]);
      }
    }
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.VER_CONJATION]) {
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.present.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.preterite.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.imperfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.presentPerfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].ver.future.forEach(addProblem);
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.VIR_CONJUGATION]) {
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.present.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.preterite.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.imperfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.presentPerfect.forEach(addProblem);
    _resources_conjugation_ver_vir_yaml__WEBPACK_IMPORTED_MODULE_0__["default"].vir.future.forEach(addProblem);
  }

  if (state.selectedExercises[_constants__WEBPACK_IMPORTED_MODULE_2__.EXERCISE.WEAK_PHRASES]) {
    _resources_weak_phrases_yaml__WEBPACK_IMPORTED_MODULE_1__["default"].forEach(addProblem);
  }

  state.problems = (0,_utils__WEBPACK_IMPORTED_MODULE_6__.shuffleArray)(problems);

  renderContent();
}

function playTranslationAudio() {
  const numProblems = state.problems.length

  if (numProblems === 0) {
    return;
  }

  const currentIndex = state.index % numProblems;
  const currentProblem = state.problems[currentIndex];
  (0,_speak__WEBPACK_IMPORTED_MODULE_4__.speak)(currentProblem[currentProblem[2]])
}

function advance() {
  if (state.revealed) {
    state.index++;
    state.revealed = false;
  } else {
    state.revealed = true;
  }
  renderContent();
}

function rewind() {
  state.revealed = false;
  state.index--;
  if (state.index < 0) state.index = state.problems.length - 1;
  renderContent();
}

function setupListeners() {
  buttonNext.addEventListener('click', advance);
  buttonPrev.addEventListener('click', rewind);
  buttonReshuffle.addEventListener('click', shuffleQuestions);
  buttonSpeak.addEventListener('click', playTranslationAudio);
  document.addEventListener('keydown', handleKeyPress);
  formQuestionOrder.addEventListener('change', handleQuestionOrderChange)
  formSelectExercises.addEventListener('change', handleSelectExerciseCheck)
}

/**
 * @param {KeyboardEvent} ev
 */
function handleKeyPress(ev) {
  if (!ev) return;

  if ((0,_keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.isCharPressed)(ev, _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.SpecialKey.ArrowRight)) {
    advance();
  } else if ((0,_keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.isCharPressed)(ev, _keyboardUtils__WEBPACK_IMPORTED_MODULE_3__.SpecialKey.ArrowLeft)) {
    rewind();
  }
}

/**
 * @param {KeyboardEvent} ev
 */
function handleQuestionOrderChange(ev) {
  state.order = ev.target.value;
  _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_5__.optionsStore.setOrder(ev.target.value);
  shuffleQuestions();
}

/**
 * @param {KeyboardEvent} ev
 */
function handleSelectExerciseCheck(ev) {
  state.selectedExercises[ev.target.name] = ev.target.checked;
  _stores_OptionsStore__WEBPACK_IMPORTED_MODULE_5__.optionsStore.setSelectedExercise(ev.target.name, ev.target.checked);
  shuffleQuestions();
}

function renderContent() {
  const numProblems = state.problems.length

  if (numProblems === 0) {
    cardQuestionContent.innerHTML = "Please select an exercise to begin";
    cardAnswerContent.innerHTML = "Por favor selecione um exercício para começar";
    cardAnswer.classList.add('revealed');
    progress.innerHTML = "0 / 0";
    return;
  }

  const currentIndex = state.index % numProblems;
  const progressText = `${currentIndex + 1} / ${numProblems}`
  const currentProblem = state.problems[currentIndex];

  (0,_utils__WEBPACK_IMPORTED_MODULE_6__.assert)(currentProblem, `currentProblem out of bounds - tried index ${currentIndex} for array of length ${numProblems}`);

  cardQuestionContent.innerHTML = markifyText(currentProblem[0]);
  cardAnswerContent.innerHTML = markifyText(currentProblem[1]);

  if (state.revealed) {
    cardAnswer.classList.add('revealed');
  } else {
    cardAnswer.classList.remove('revealed');
  }

  progress.innerHTML = progressText;
}

function renderOptions() {
  formQuestionOrder.querySelectorAll('input').forEach(input => {
    if (input.name === 'question-order') {
      input.checked = state.order === input.value;
    }
  });

  formSelectExercises.querySelectorAll('input').forEach(input => {
    if (input.name.includes('checkbox-exercise')) {
      input.checked = state.selectedExercises[input.name];
    }
  });
}

/**
 * @param {string} text
 * @returns string
 */
function markifyText(text) {
  const regMarkdownBoldStart = /(?<!\S)\*\*(?!\s)/g;
  const regMarkdownBoldEnd = /(?<!\s)\*\*(?!\S)/g;
  return text
    .replace(regMarkdownBoldStart, "<strong class=\"accent\">")
    .replace(regMarkdownBoldEnd, "</strong>")
}

main();

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBTSwrREFBK0QsY0FBYyxzQkFBc0IsWUFBWTs7QUFFdkg7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvLi9zcmMvcmVzb3VyY2VzL2Nvbmp1Z2F0aW9uLXZlci12aXIueWFtbCIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvLi9zcmMvcmVzb3VyY2VzL3dlYWstcGhyYXNlcy55YW1sIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL2tleWJvYXJkVXRpbHMuanMiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lLy4vc3JjL3NwZWFrLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9zdG9yZXMvQmFzZVN0b3JlLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy9zdG9yZXMvT3B0aW9uc1N0b3JlLmpzIiwid2VicGFjazovL3BvcnR1Z3Vlc2UtZ2FtZS8uL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcG9ydHVndWVzZS1nYW1lL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9wb3J0dWd1ZXNlLWdhbWUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQge3Zlcjp7cHJlc2VudDpbe3ByOidldSB2ZWpvIG8gc29sIHRvZG9zIG9zIGRpYXMnLGVuOidJIHNlZSB0aGUgc3VuIGV2ZXJ5IGRheSd9LHtwcjonZWxlIHbDqiBvcyBww6Fzc2Fyb3Mgdm9hbmRvJyxlbjonaGUgc2VlcyB0aGUgYmlyZHMgZmx5aW5nJ30se3ByOiduw7NzIHZlbW9zIG8gbWFyIGRhcXVpJyxlbjond2Ugc2VlIHRoZSBzZWEgZnJvbSBoZXJlJ30se3ByOidlbGVzIHZlZW0gb3MgYW5pbWFpcyBuYSBmbG9yZXN0YScsZW46J3RoZSBzZWUgdGhlIGFuaW1hbHMgaW4gdGhlIGZvcmVzdCd9XSxpbXBlcmZlY3Q6W3twcjonZXUgdmlhIG9zIGNhcnJvcyBwYXNzYXJlbSBuYSBydWEnLGVuOidJIHVzZWQgdG8gc2VlIHRoZSBjYXJzIHBhc3NpbmcgaW4gdGhlIHJvYWQnfSx7cHI6J2VsZSB2aWEgb3MgYW5pbWFpcyBuYSBmbG9yZXN0YScsZW46J2hlIHVzZWQgdG8gc2VlIHRoZSBhbmltYWxzIGluIHRoZSBmb3Jlc3QnfSx7cHI6J27Ds3MgdsOtYW1vcyBvIHDDtHIgZG8gc29sIG5hIHByYWlhJyxlbjond2UgdXNlZCB0byBzZWUgdGhlIHN1bnNldCBvbiB0aGUgYmVhY2gnfSx7cHI6J2VsZXMgdmlhbSBhIGx1YSBubyBjw6l1JyxlbjondGhleSB1c2VkIHRvIHNlZSB0aGUgbW9vbiBpbiB0aGUgc2t5J31dLHByZXRlcml0ZTpbe3ByOidldSB2aSBvIGZpbG1lIG9udGVtJyxlbjonSSBzYXcgdGhlIGZpbG0geWVzdGVyZGF5J30se3ByOidlbGUgdml1IG8gdHJlbSBwYXNzYXInLGVuOidoZSBzYXcgdGhlIHRyYWluIHBhc3MnfSx7cHI6J27Ds3Mgdmltb3MgbyBtYXIgYWdpdGFkbycsZW46J3dlIHNhdyB0aGUgcm91Z2ggc2VhJ30se3ByOidlbGVzIHZpcmFtIG8gZWNsaXBzZSBkYSBsdWEnLGVuOid0aGV5IHNhdyB0aGUgZWNsaXBzZSBvZiB0aGUgbW9vbid9XSxwcmVzZW50UGVyZmVjdDpbe3ByOidldSB0ZW5obyB2aXN0byBtdWl0b3MgZmlsbWVzIGJvbnMnLGVuOidJIGhhdmUgc2VlbiBtYW55IGdvb2QgZmlsbXMnfSx7cHI6J2VsZSB0ZW0gdmlzdG8gbXVpdGFzIGVzdHJlbGFzIMOgIG5vaXRlJyxlbjonaGUgaGFzIHNlZW4gbWFueSBzdGFycyBhdCBuaWdodCd9LHtwcjonbsOzcyB0ZW1vcyB2aXN0byBvIHDDtHIgZG8gc29sIGp1bnRvcycsZW46J3dlIGhhdmUgc2VlbiB0aGUgc3Vuc2V0IHRvZ2V0aGVyJ30se3ByOidlbGVzIHTDqm0gdmlzdG8gb3MgZm9nb3MgZGUgYXJ0aWbDrWNpbyBubyBjw6l1JyxlbjondGhleSBoYXZlIHNlZW4gdGhlIGZpcmV3b3JrcyBpbiB0aGUgc2t5J31dLGZ1dHVyZTpbe3ByOidldSB2ZXJlaSBvIG5hc2NlciBkbyBzb2wgYW1hbmjDoycsZW46J0kgd2lsbCBzZWUgdGhlIHN1bnJpc2UgdG9tb3Jyb3cnfSx7cHI6J2VsZSB2ZXLDoSBvcyBmb2dvcyBkZSBhcnRpZsOtY2lvIG5vIHJldmVpbGxvbicsZW46J0hlIHdpbGwgc2VlIHRoZSBmaXJld29ya3Mgb24gTmV3IFllYXJcXCdzIEV2ZSd9LHtwcjonbsOzcyB2ZXJlbW9zIG8gbWFyIGF6dWwgbmEgdmlhZ2VtJyxlbjond2Ugd2lsbCBzZWUgdGhlIGJsdWUgc2VhIG9uIHRoZSBqb3VybmV5J30se3ByOidlbGVzIHZlcsOjbyBhcyBmbG9yZXMgbm8gamFyZGltJyxlbjondGhleSB3aWxsIHNlZSB0aGUgZmxvd2VycyBpbiB0aGUgZ2FyZGVuJ31dfSx2aXI6e3ByZXNlbnQ6W3twcjonZXUgdmVuaG8gc2VtcHJlIGFvIHBhcnF1ZScsZW46J0kgYWx3YXlzIGNvbWUgdG8gdGhlIHBhcmsnfSx7cHI6J2VsYSB2ZW0gbWFpcyB0YXJkZScsZW46J3NoZSBjb21lcyBsYXRlcid9LHtwcjonbsOzcyB2aW1vcyBvIGZpbG1lIGp1bnRvcycsZW46J3dlIHNlZSB0aGUgZmlsbSB0b2dldGhlcid9LHtwcjonZWxlcyB2w6ptIGRlIGxvbmdlJyxlbjondGhleSBjb21lIGZyb20gYWZhcid9XSxpbXBlcmZlY3Q6W3twcjonZXUgdmluaGEgYW8gcGFycXVlIHRvZG9zIG9zIGRpYXMnLGVuOidJIHVzZWQgdG8gY29tZSB0byB0aGUgcGFyayBldmVyeSBkYXknfSx7cHI6J2VsZSB2aW5oYSBsZXIgYXF1aSDDoCB0YXJkZScsZW46J2hlIHVzZWQgdG8gY29tZSByZWFkIGhlcmUgaW4gdGhlIGFmdGVybm9vbid9LHtwcjonbsOzcyB2aW5oYW1vcyBzZW1wcmUgYW50ZXMgZG8gamFudGFyJyxlbjond2UgdXNlZCB0byBhbHdheXMgY29tZSBiZWZvcmUgZGlubmVyJ30se3ByOidlbGVzIHZpbmhhbSBqb2dhciBmdXRlYm9sIHRvZGFzIGFzIHRhcmRlcycsZW46J3RoZXkgdXNlZCB0byBjb21lIHBsYXkgc29jY2VyIGV2ZXJ5IGFmdGVybm9vbid9XSxwcmV0ZXJpdGU6W3twcjonZXUgdmltIMOgIHByYWlhIGhvamUnLGVuOidJIGNhbWUgdG8gdGhlIGJlYWNoIHRvZGF5J30se3ByOidlbGUgdmVpbyBhanVkYXIgYSBhdsOzJyxlbjonaGUgY2FtZSB0byBoZWxwIGhpcyBncmFubW90aGVyJ30se3ByOiduw7NzIHZpZW1vcyBhbG1vw6dhciBjb250aWdvJyxlbjond2UgY2FtZSB0byBoYXZlIGx1bmNoIHdpdGggeW91J30se3ByOidlbGVzIHZpZXJhbSByw6FwaWRvIGRlbWFpcycsZW46J3RoZXkgY2FtZSB0b28gZmFzdCd9XSxwcmVzZW50UGVyZmVjdDpbe3ByOidldSB0ZWhubyB2aW5kbyBhcXVpIGNvbSBmcmVxdcOqbmNpYScsZW46J0kgaGF2ZSBiZWVuIGNvbWluZyBoZXJlIG9mdGVuJ30se3ByOidlbGUgdGVtIHZpbmRvIGFqdWRhciBvcyBvdXRyb3MnLGVuOidoZSBoYXMgYmVlbiBjb21pbmcgdG8gaGVscCBvdGhlcnMnfSx7cHI6J27Ds3MgdGVtb3MgdmluZG8gcGFzc2VhciBubyBwYXJxdWUnLGVuOid3ZSBoYXZlIGJlZW4gY29taW5nIGZvciBhIHdhbGsgaW4gdGhlIHBhcmsnfSx7cHI6J2VsZXMgdMOqbSB2aW5kbyBicmluY2FyIG5vIHBhcnF1ZScsZW46J3RoZXkgaGF2ZSBiZWVuIGNvbWluZyB0byBwbGF5IGluIHRoZSBwYXJrJ31dLGZ1dHVyZTpbe3ByOidldSB2aXJlaSBidXNjYXIgdm9jw6ogbWFpcyB0YXJkZScsZW46J0kgd2lsbCBjb21lIGZpbmQgeW91IGxhdGVyJ30se3ByOidlbGUgdmlyw6EgYWp1ZGFyIG5hIGZlc3RhJyxlbjonaGUgd2lsbCBjb21lIGhlbHAgYXQgdGhlIHBhcnR5J30se3ByOiduw7NzIHZpcmVtb3MgamFudGFyIGp1bnRvcycsZW46J3dlIHdpbGwgY29tZSB0byBkaW5uZXIgdG9nZXRoZXInfSx7cHI6J2VsZXMgdmlyw6NvIG5vIHByw7N4aW1vIGZpbmFsIGRlIHNlbWFuYScsZW46J3RoZXkgd2lsbCBjb21lIG5leHQgd2Vla2VuZCd9XX19OyIsImV4cG9ydCBkZWZhdWx0IFt7cHI6J0VsZSDDqSB1bSBjb2xlY2lvbmFkb3IgcXVlIGNvbGVjaW9uYSBpdGVucycsZW46J0hlIGlzIGEgY29sbGVjdG9yIHdobyBjb2xsZWN0cyBpdGVtcyd9LHtwcjonVGVuaG8gdW1hIGNvbGXDp8OjbycsZW46J0kgaGF2ZSBhIGNvbGxlY3Rpb24nfSx7cHI6J1ZvdSAqKmdhbmhhcioqIG1haXMgZGluaGVpcm8gbmFxdWVsYSBob3JhJyxlbjonSSB3aWxsICoqZ2V0KiogbW9yZSBtb25leSBhdCB0aGF0IHRpbWUnfSx7cHI6J0ZvaSBlc2N1cm8gbMOhIGZvcmEnLGVuOidJdCB3YXMgZGFyayBvdXRzaWRlJ30se3ByOidFc3TDoSBmaWNhbmRvIG9zY3VybyBsw6EgZm9yYScsZW46J0l0IGlzIGdldHRpbmcgZGFyayBvdXRzaWRlJ30se3ByOidWZW5oYSBtZSBjb25oZWNlciBhbGd1bSBkaWEnLGVuOidDb21lIGFuZCBtZWV0IG1lIHNvbWUgZGF5J30se3ByOidWZW5oYSBtZSB2ZXIgYWxndW0gZGlhJyxlbjonQ29tZSBhbmQgc2VlIG1lIHNvbWUgZGF5J30se3ByOidOw6NvIHBlcmNhIGEgZsOpJyxlbjonRG8gbm90IGxvc2UgZmFpdGgnfSx7cHI6J0hlIGRvZXMgbm90IGxvc2UgZmFpdGgnLGVuOidFbGUgbsOjbyBwZXJkZSBhIGbDqSd9LHtwcjonRWxhIG1lIGFwcmVzZW50b3UgYW8gc2V1IG5hbW9yYWRvIG5hIGZlc3RhJyxlbjonU2hlIGludHJvZHVjZWQgbWUgdG8gaGVyIGJveWZyaWVuZCBhdCB0aGUgcGFydHknfSx7cHI6J0VsZSBsZXZvdSBtZXUgY2FzYWNvJyxlbjonSGUgdG9vayBteSBjb2F0J30se3ByOidFdSB0ZSBkb3UgZXN0ZSByZWzDs2dpbyBjb21vIHVtIHByZXNlbnRlJyxlbjonSSBnaXZlIHRoaXMgd2F0Y2ggdG8geW91IGFzIGEgZ2lmdCd9LHtwcjonRXUgc29uaGVpIHVtIHNvbmhvIGRlIHVtIHRlbXBvIHBhc3NhZG8nLGVuOidJIGRyZWFtZWQgYSBkcmVhbSBvZiB0aW1lIGdvbmUgYnknfSx7cHI6J0V1IG1lIGRpdmVydGkgbXVpdG8nLGVuOidJIGhhZCBhIGdvb2QgdGltZSd9LHtwcjonRm9pIHVtIGJvbSBtb21lbnRvJyxlbjonSXQgd2FzIGEgZ29vZCB0aW1lJ30se3ByOidFbGUgdmVpbyBkZSBsb25nZScsZW46J0hlIGNhbWUgZnJvbSBmYXIgYXdheSd9LHtwcjonRXN0b3UgdmluZG8nLGVuOidJIGFtIGNvbWluZyd9LHtwcjonQ29udGludWUgZW0gZnJlbnRlLCBwb3IgZmF2b3InLGVuOidLZWVwIGdvaW5nIGZvcndhcmQsIHBsZWFzZSd9LHtwcjonQSBsdXogw6kgYnJpbGhhbnRlJyxlbjonVGhlIGxpZ2h0IGlzIGJyaWdodCd9LHtwcjonw4kgZmF2b3LDoXZlbCBwYXJhIG7Ds3MgaXJtb3MnLGVuOidJdCBpcyBmYXZvcmFibGUgZm9yIHVzIHRvIGdvJ30se3ByOidFdSBwZW5zZWkgcXVlIG5vc3NvICoqY29tcHJvbWlzc28qKiBzZXJpYSBuYSBzZW1hbmEgcXVlIHZlbScsZW46J0kgdGhvdWdodCB0aGF0IG91ciAqKm1lZXRpbmcqKiB3YXMgbmV4dCB3ZWVrJ30se3ByOidJc3NvIG7Do28gcXVlciBkaXplciBuYWRhJyxlbjonVGhpcyBkb2VzblxcJ3QgbWVhbiBhbnl0aGluZyd9LHtwcjonRWxlcyBtZSAqKmTDo28qKiBhcnJveicsZW46J1RoZXkgKipnaXZlKiogbWUgcmljZSd9LHtwcjonRWxlIG7Do28gZGV2ZSB2aXIgYXF1aSBub3ZhbWVudGUnLGVuOidIZSBtdXN0IG5vdCBjb21lIGhlcmUgYWdhaW4nfSx7cHI6J0jDoSBvdXRyb3MgZmF0b3JlcyBxdWUgbm9zIGZhemVtIHBlbnNhciBhc3NpbScsZW46J1RoZXJlIGFyZSBvdGhlciBmYWN0b3JzIHRoYXQgbWFrZSB1cyB0aGluayBsaWtlIHRoYXQnfSx7cHI6J0VsYSBub3MgZXhwbG9yYScsZW46J1NoZSBleHBsb2l0cyB1cyd9LHtwcjonTyByZXN0YXVyYW50ZSBmaWNhIGVtIGZyZW50ZSDDoCBlc2NvbGEnLGVuOidUaGUgcmVzdGF1cmFudCBpcyBpbiBmcm9udCBvZiB0aGUgc2Nob29sJ30se3ByOidFc3RlIMOpIG1ldSB0aXBvIGRlIHBlcnNvbmFnZW0nLGVuOidUaGlzIGlzIG15IHR5cGUgb2YgY2hhcmFjdGVyJ30se3ByOidFdSBuw6NvIHZlam8gbWluaGEgbmFtb3JhZGEgaMOhIGR1YXMgc2VtYW5hcycsZW46J0kgaGF2ZSBub3Qgc2VlbiBteSBnaXJsZnJpZW5kIGZvciB0d28gd2Vla3MnfSx7cHI6J0NvbW8gdGVtIHBhc3NhZG8gbyBzZXUgcGFpPycsZW46J0hvdyBoYXMgeW91ciBmYXRoZXIgYmVlbj8nfSx7cHI6J01ldSBmaWxobyB0ZW0gbWUgcGVyZ3VudGFkbyAqKmNvaXNhcyBlc3RyYW5oYXMqKicsZW46J015IHNvbiBoYXMgYmVlbiBhc2tpbmcgbWUgKipzdHJhbmdlIHF1ZXN0aW9ucyoqJ30se3ByOidUZW50ZSBkZXNjb2JyaXIgc2UgdHVkbyBxdWUgZWxlIGRpc3NlIMOpIHZlcmRhZGUnLGVuOidUcnkgdG8gZmluZCBvdXQgaWYgZXZlcnl0aGluZyB0aGF0IGhlIHNhaWQgaXMgdHJ1ZSd9LHtwcjonRWxlIG1lIGNvbnRhIHR1ZG8nLGVuOidIZSB0ZWxscyBtZSBldmVyeXRoaW5nJ30se3ByOidFdSBzZWd1cmVpIHVtIGJlYsOpIGVtIG1ldXMgYnJhw6dvcycsZW46J0kgaGVsZCBhIGJhYnkgaW4gbXkgYXJtcyd9XTsiLCJcbmV4cG9ydCBjb25zdCBPUkRFUiA9IHtcbiAgUFJfRklSU1Q6ICdwci1maXJzdCcsXG4gIEVOX0ZJUlNUOiAnZW4tZmlyc3QnLFxuICBBTlk6ICdhbnknLFxufVxuXG5leHBvcnQgY29uc3QgRVhFUkNJU0UgPSB7XG4gIFZFUl9DT05KQVRJT046ICdjaGVja2JveC1leGVyY2lzZS12ZXItY29uanVnYXRpb24nLFxuICBWSVJfQ09OSlVHQVRJT046ICdjaGVja2JveC1leGVyY2lzZS12aXItY29uanVnYXRpb24nLFxuICBXRUFLX1BIUkFTRVM6ICdjaGVja2JveC1leGVyY2lzZS13ZWFrLXBocmFzZXMnLFxufVxuIiwiXG5leHBvcnQgY29uc3QgU3BlY2lhbEtleSA9IHtcbiAgQmFja3NwYWNlOiAnYmFja3NwYWNlJyxcbiAgRXNjYXBlOiAnZXNjYXBlJyxcbiAgVGFiOiAndGFiJyxcbiAgU3BhY2U6ICdzcGFjZScsXG4gIEVudGVyOiAnZW50ZXInLFxuICBEZWxldGU6ICdkZWxldGUnLFxuICBBcnJvd1VwOiAnQXJyb3dVcCcsXG4gIEFycm93RG93bjogJ0Fycm93RG93bicsXG4gIEFycm93TGVmdDogJ0Fycm93TGVmdCcsXG4gIEFycm93UmlnaHQ6ICdBcnJvd1JpZ2h0Jyxcbn1cblxuLyoqXG4gKiBLZXlib2FyZCBvcHRpb25zXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBLZXlib2FyZE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2N0cmxLZXldIC0gY29udHJvbCBrZXkgaXMgcHJlc3NlZC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW3NoaWZ0S2V5XSAtIHNoaWZ0IGtleSBpcyBwcmVzc2VkLlxuICogQHByb3BlcnR5IHtib29sZWFufSBbYWx0S2V5XSAtIGFsdCBrZXkgaXMgcHJlc3NlZC5cbiAqL1xuXG4vKipcbiAqIGRldGVybWluZSB3aGV0aGVyIGEgbnVtYmVyIGlzIHByZXNzZWRcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXYgXG4gKiBAcGFyYW0ge251bWJlcn0gbnVtIFxuICogQHBhcmFtIHtLZXlib2FyZE9wdGlvbnN9IFtvcHRzXVxuICogQHJldHVybnMgYm9vbGVhblxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNOdW1iZXJQcmVzc2VkKGV2LCBudW0sIG9wdHMgPSB7fSkge1xuICBpZiAoIWFyZU9wdGlvbnNTYXRpc2ZpZWQoZXYsIG9wdHMpKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBmaW5kTnVtYmVyUHJlc3NlZChldikgPT09IG51bTtcbn1cblxuLyoqXG4gKiBkZXRlcm1pbmUgd2hldGhlciBhIGNoYXIgaXMgcHJlc3NlZFxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldiBcbiAqIEBwYXJhbSB7c3RyaW5nfSBjaGFyXG4gKiBAcGFyYW0ge0tleWJvYXJkT3B0aW9uc30gW29wdHNdXG4gKiBAcmV0dXJucyBib29sZWFuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0NoYXJQcmVzc2VkKGV2LCBjaGFyLCBvcHRzID0ge30pIHtcbiAgaWYgKCFhcmVPcHRpb25zU2F0aXNmaWVkKGV2LCBvcHRzKSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gZmluZENoYXJQcmVzc2VkKGV2KSA9PT0gY2hhcjtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgd2hldGhlciBvcHRpb25zIGFyZSBzYXRpc2ZpZWQgKGN0cmwsIGFsdCwgc2hpZnQsIGV0Yy4pXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2IFxuICogQHBhcmFtIHtLZXlib2FyZE9wdGlvbnN9IFtvcHRzXVxuICogQHJldHVybnMgYm9vbGVhblxuICovXG5mdW5jdGlvbiBhcmVPcHRpb25zU2F0aXNmaWVkKGV2LCBvcHRzID0ge30pIHtcbiAgaWYgKCFldikgcmV0dXJuIGZhbHNlO1xuICBjb25zdCBpc0NvbnRyb2xQcmVzc2VkID0gZXYubWV0YUtleSB8fCBldi5jdHJsS2V5OyAvLyBtZXRhIGtleSBpcyBDTUQga2V5IG9uIG1hY1xuICBjb25zdCBpc1NoaWZ0UHJlc3NlZCA9IGV2LnNoaWZ0S2V5O1xuICBjb25zdCBpc0FsdEtleVByZXNzZWQgPSBldi5hbHRLZXk7XG4gIGlmIChvcHRzLmN0cmxLZXkgJiYgIWlzQ29udHJvbFByZXNzZWQpIHJldHVybiBmYWxzZTtcbiAgaWYgKG9wdHMuc2hpZnRLZXkgJiYgIWlzU2hpZnRQcmVzc2VkKSByZXR1cm4gZmFsc2U7XG4gIGlmIChvcHRzLmFsdEtleSAmJiAhaXNBbHRLZXlQcmVzc2VkKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEZpbmQgbnVtYmVyIHByZXNzZWQsIG9yIC0xIGlmIG5vIG1hdGNoIGZvdW5kXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2XG4gKiBAcmV0dXJucyBudW1iZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmROdW1iZXJQcmVzc2VkKGV2KSB7XG4gIGlmIChldi5rZXkgPT09ICcwJyB8fCBldi5jb2RlID09PSAnRGlnaXQwJyB8fCBldi5jb2RlID09PSAnTnVtcGFkMCcgfHwgZXYua2V5Q29kZSA9PT0gNDggfHwgZXYua2V5Q29kZSA9PT0gOTYpIHJldHVybiAwO1xuICBpZiAoZXYua2V5ID09PSAnMScgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0MScgfHwgZXYuY29kZSA9PT0gJ051bXBhZDEnIHx8IGV2LmtleUNvZGUgPT09IDQ5IHx8IGV2LmtleUNvZGUgPT09IDk3KSByZXR1cm4gMTtcbiAgaWYgKGV2LmtleSA9PT0gJzInIHx8IGV2LmNvZGUgPT09ICdEaWdpdDInIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQyJyB8fCBldi5rZXlDb2RlID09PSA1MCB8fCBldi5rZXlDb2RlID09PSA5OCkgcmV0dXJuIDI7XG4gIGlmIChldi5rZXkgPT09ICczJyB8fCBldi5jb2RlID09PSAnRGlnaXQzJyB8fCBldi5jb2RlID09PSAnTnVtcGFkMycgfHwgZXYua2V5Q29kZSA9PT0gNTEgfHwgZXYua2V5Q29kZSA9PT0gOTkpIHJldHVybiAzO1xuICBpZiAoZXYua2V5ID09PSAnNCcgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0NCcgfHwgZXYuY29kZSA9PT0gJ051bXBhZDQnIHx8IGV2LmtleUNvZGUgPT09IDUyIHx8IGV2LmtleUNvZGUgPT09IDEwMCkgcmV0dXJuIDQ7XG4gIGlmIChldi5rZXkgPT09ICc1JyB8fCBldi5jb2RlID09PSAnRGlnaXQ1JyB8fCBldi5jb2RlID09PSAnTnVtcGFkNScgfHwgZXYua2V5Q29kZSA9PT0gNTMgfHwgZXYua2V5Q29kZSA9PT0gMTAxKSByZXR1cm4gNTtcbiAgaWYgKGV2LmtleSA9PT0gJzYnIHx8IGV2LmNvZGUgPT09ICdEaWdpdDYnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQ2JyB8fCBldi5rZXlDb2RlID09PSA1NCB8fCBldi5rZXlDb2RlID09PSAxMDIpIHJldHVybiA2O1xuICBpZiAoZXYua2V5ID09PSAnNycgfHwgZXYuY29kZSA9PT0gJ0RpZ2l0NycgfHwgZXYuY29kZSA9PT0gJ051bXBhZDcnIHx8IGV2LmtleUNvZGUgPT09IDU1IHx8IGV2LmtleUNvZGUgPT09IDEwMykgcmV0dXJuIDc7XG4gIGlmIChldi5rZXkgPT09ICc4JyB8fCBldi5jb2RlID09PSAnRGlnaXQ4JyB8fCBldi5jb2RlID09PSAnTnVtcGFkOCcgfHwgZXYua2V5Q29kZSA9PT0gNTYgfHwgZXYua2V5Q29kZSA9PT0gMTA0KSByZXR1cm4gODtcbiAgaWYgKGV2LmtleSA9PT0gJzknIHx8IGV2LmNvZGUgPT09ICdEaWdpdDknIHx8IGV2LmNvZGUgPT09ICdOdW1wYWQ5JyB8fCBldi5rZXlDb2RlID09PSA1NyB8fCBldi5rZXlDb2RlID09PSAxMDUpIHJldHVybiA5O1xuICByZXR1cm4gLTE7XG59XG5cbi8qKlxuICogRmluZCBjaGFyIHByZXNzZWQsIG9yIFwiXCIgaWYgbm8gbWF0Y2ggZm91bmRcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqIEByZXR1cm5zIHN0cmluZ1xuICovXG5mdW5jdGlvbiBmaW5kQ2hhclByZXNzZWQoZXYpIHtcbiAgY29uc3QgbnVtID0gZmluZE51bWJlclByZXNzZWQoZXYpO1xuICBpZiAobnVtICE9PSAtMSkgcmV0dXJuIFN0cmluZyhudW0pO1xuICBpZiAoZXYua2V5ID09PSAnYScgfHwgZXYuY29kZSA9PT0gJ0tleUEnIHx8IGV2LmtleUNvZGUgPT09IDY1KSByZXR1cm4gJ2EnO1xuICBpZiAoZXYua2V5ID09PSAnYicgfHwgZXYuY29kZSA9PT0gJ0tleUInIHx8IGV2LmtleUNvZGUgPT09IDY2KSByZXR1cm4gJ2InO1xuICBpZiAoZXYua2V5ID09PSAnYycgfHwgZXYuY29kZSA9PT0gJ0tleUMnIHx8IGV2LmtleUNvZGUgPT09IDY3KSByZXR1cm4gJ2MnO1xuICBpZiAoZXYua2V5ID09PSAnZCcgfHwgZXYuY29kZSA9PT0gJ0tleUQnIHx8IGV2LmtleUNvZGUgPT09IDY4KSByZXR1cm4gJ2QnO1xuICBpZiAoZXYua2V5ID09PSAnZScgfHwgZXYuY29kZSA9PT0gJ0tleUUnIHx8IGV2LmtleUNvZGUgPT09IDY5KSByZXR1cm4gJ2UnO1xuICBpZiAoZXYua2V5ID09PSAnZicgfHwgZXYuY29kZSA9PT0gJ0tleUYnIHx8IGV2LmtleUNvZGUgPT09IDcwKSByZXR1cm4gJ2YnO1xuICBpZiAoZXYua2V5ID09PSAnZycgfHwgZXYuY29kZSA9PT0gJ0tleUcnIHx8IGV2LmtleUNvZGUgPT09IDcxKSByZXR1cm4gJ2cnO1xuICBpZiAoZXYua2V5ID09PSAnaCcgfHwgZXYuY29kZSA9PT0gJ0tleUgnIHx8IGV2LmtleUNvZGUgPT09IDcyKSByZXR1cm4gJ2gnO1xuICBpZiAoZXYua2V5ID09PSAnaScgfHwgZXYuY29kZSA9PT0gJ0tleUknIHx8IGV2LmtleUNvZGUgPT09IDczKSByZXR1cm4gJ2knO1xuICBpZiAoZXYua2V5ID09PSAnaicgfHwgZXYuY29kZSA9PT0gJ0tleUonIHx8IGV2LmtleUNvZGUgPT09IDc0KSByZXR1cm4gJ2onO1xuICBpZiAoZXYua2V5ID09PSAnaycgfHwgZXYuY29kZSA9PT0gJ0tleUsnIHx8IGV2LmtleUNvZGUgPT09IDc1KSByZXR1cm4gJ2snO1xuICBpZiAoZXYua2V5ID09PSAnbCcgfHwgZXYuY29kZSA9PT0gJ0tleUwnIHx8IGV2LmtleUNvZGUgPT09IDc2KSByZXR1cm4gJ2wnO1xuICBpZiAoZXYua2V5ID09PSAnbScgfHwgZXYuY29kZSA9PT0gJ0tleU0nIHx8IGV2LmtleUNvZGUgPT09IDc3KSByZXR1cm4gJ20nO1xuICBpZiAoZXYua2V5ID09PSAnbicgfHwgZXYuY29kZSA9PT0gJ0tleU4nIHx8IGV2LmtleUNvZGUgPT09IDc4KSByZXR1cm4gJ24nO1xuICBpZiAoZXYua2V5ID09PSAnbycgfHwgZXYuY29kZSA9PT0gJ0tleU8nIHx8IGV2LmtleUNvZGUgPT09IDc5KSByZXR1cm4gJ28nO1xuICBpZiAoZXYua2V5ID09PSAncCcgfHwgZXYuY29kZSA9PT0gJ0tleVAnIHx8IGV2LmtleUNvZGUgPT09IDgwKSByZXR1cm4gJ3AnO1xuICBpZiAoZXYua2V5ID09PSAncScgfHwgZXYuY29kZSA9PT0gJ0tleVEnIHx8IGV2LmtleUNvZGUgPT09IDgxKSByZXR1cm4gJ3EnO1xuICBpZiAoZXYua2V5ID09PSAncicgfHwgZXYuY29kZSA9PT0gJ0tleVInIHx8IGV2LmtleUNvZGUgPT09IDgyKSByZXR1cm4gJ3InO1xuICBpZiAoZXYua2V5ID09PSAncycgfHwgZXYuY29kZSA9PT0gJ0tleVMnIHx8IGV2LmtleUNvZGUgPT09IDgzKSByZXR1cm4gJ3MnO1xuICBpZiAoZXYua2V5ID09PSAndCcgfHwgZXYuY29kZSA9PT0gJ0tleVQnIHx8IGV2LmtleUNvZGUgPT09IDg0KSByZXR1cm4gJ3QnO1xuICBpZiAoZXYua2V5ID09PSAndScgfHwgZXYuY29kZSA9PT0gJ0tleVUnIHx8IGV2LmtleUNvZGUgPT09IDg1KSByZXR1cm4gJ3UnO1xuICBpZiAoZXYua2V5ID09PSAndicgfHwgZXYuY29kZSA9PT0gJ0tleVYnIHx8IGV2LmtleUNvZGUgPT09IDg2KSByZXR1cm4gJ3YnO1xuICBpZiAoZXYua2V5ID09PSAndycgfHwgZXYuY29kZSA9PT0gJ0tleVcnIHx8IGV2LmtleUNvZGUgPT09IDg3KSByZXR1cm4gJ3cnO1xuICBpZiAoZXYua2V5ID09PSAneCcgfHwgZXYuY29kZSA9PT0gJ0tleVgnIHx8IGV2LmtleUNvZGUgPT09IDg4KSByZXR1cm4gJ3gnO1xuICBpZiAoZXYua2V5ID09PSAneScgfHwgZXYuY29kZSA9PT0gJ0tleVknIHx8IGV2LmtleUNvZGUgPT09IDg5KSByZXR1cm4gJ3knO1xuICBpZiAoZXYua2V5ID09PSAneicgfHwgZXYuY29kZSA9PT0gJ0tleVonIHx8IGV2LmtleUNvZGUgPT09IDkwKSByZXR1cm4gJ3onO1xuICBpZiAoZXYua2V5ID09PSAnYCcgfHwgZXYuY29kZSA9PT0gJ0JhY2txdW90ZScgfHwgZXYua2V5Q29kZSA9PT0gMTkyKSByZXR1cm4gJ2AnO1xuICBpZiAoZXYua2V5ID09PSAnLScgfHwgZXYuY29kZSA9PT0gJ01pbnVzJyB8fCBldi5rZXlDb2RlID09PSAxODkpIHJldHVybiAnLSc7XG4gIGlmIChldi5rZXkgPT09ICc9JyB8fCBldi5jb2RlID09PSAnRXF1YWxzJyB8fCBldi5rZXlDb2RlID09PSAxODcpIHJldHVybiAnPSc7XG4gIGlmIChldi5rZXkgPT09ICctJyB8fCBldi5jb2RlID09PSAnTnVtcGFkU3VidHJhY3QnIHx8IGV2LmtleUNvZGUgPT09IDEwOSkgcmV0dXJuICctJztcbiAgaWYgKGV2LmtleSA9PT0gJysnIHx8IGV2LmNvZGUgPT09ICdOdW1wYWRBZGQnIHx8IGV2LmtleUNvZGUgPT09IDEwNykgcmV0dXJuICcrJztcbiAgaWYgKGV2LmtleSA9PT0gJ1snIHx8IGV2LmNvZGUgPT09ICdCcmFja2V0TGVmdCcgfHwgZXYua2V5Q29kZSA9PT0gMjE5KSByZXR1cm4gJ1snO1xuICBpZiAoZXYua2V5ID09PSAnXScgfHwgZXYuY29kZSA9PT0gJ0JyYWNrZXRSaWdodCcgfHwgZXYua2V5Q29kZSA9PT0gMjIxKSByZXR1cm4gJ10nO1xuICBpZiAoZXYua2V5ID09PSAnQmFja3NwYWNlJyB8fCBldi5jb2RlID09PSAnQmFja3NwYWNlJyB8fCBldi5rZXlDb2RlID09PSAyMjEpIHJldHVybiBTcGVjaWFsS2V5LkJhY2tzcGFjZTtcbiAgaWYgKGV2LmtleSA9PT0gJ0VzY2FwZScgfHwgZXYuY29kZSA9PT0gJ0VzY2FwZScgfHwgZXYua2V5Q29kZSA9PT0gMjcpIHJldHVybiBTcGVjaWFsS2V5LkVzY2FwZTtcbiAgaWYgKGV2LmtleSA9PT0gJyAnIHx8IGV2LmNvZGUgPT09ICdTcGFjZScgfHwgZXYua2V5Q29kZSA9PT0gMzIpIHJldHVybiBTcGVjaWFsS2V5LlNwYWNlO1xuICBpZiAoZXYua2V5ID09PSAnRW50ZXInIHx8IGV2LmNvZGUgPT09ICdFbnRlcicgfHwgZXYuY29kZSA9PT0gJ051bXBhZEVudGVyJyB8fCBldi5rZXlDb2RlID09PSAxMykgcmV0dXJuIFNwZWNpYWxLZXkuRW50ZXI7XG4gIGlmIChldi5rZXkgPT09ICdEZWxldGUnIHx8IGV2LmNvZGUgPT09ICdEZWxldGUnIHx8IGV2LmtleUNvZGUgPT09IDQ2KSByZXR1cm4gU3BlY2lhbEtleS5EZWxldGU7XG4gIGlmIChldi5rZXkgPT09ICdBcnJvd1VwJyB8fCBldi5jb2RlID09PSAnQXJyb3dVcCcgfHwgZXYua2V5Q29kZSA9PT0gMzgpIHJldHVybiBTcGVjaWFsS2V5LkFycm93VXA7XG4gIGlmIChldi5rZXkgPT09ICdBcnJvd0Rvd24nIHx8IGV2LmNvZGUgPT09ICdBcnJvd0Rvd24nIHx8IGV2LmtleUNvZGUgPT09IDQwKSByZXR1cm4gU3BlY2lhbEtleS5BcnJvd0Rvd247XG4gIGlmIChldi5rZXkgPT09ICdBcnJvd0xlZnQnIHx8IGV2LmNvZGUgPT09ICdBcnJvd0xlZnQnIHx8IGV2LmtleUNvZGUgPT09IDM3KSByZXR1cm4gU3BlY2lhbEtleS5BcnJvd0xlZnQ7XG4gIGlmIChldi5rZXkgPT09ICdBcnJvd1JpZ2h0JyB8fCBldi5jb2RlID09PSAnQXJyb3dSaWdodCcgfHwgZXYua2V5Q29kZSA9PT0gMzkpIHJldHVybiBTcGVjaWFsS2V5LkFycm93UmlnaHQ7XG4gIHJldHVybiAnJ1xufVxuIiwiaW1wb3J0IHsgcmVxdWlyZUJ5SWQgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3Qgc3ludGggPSB3aW5kb3cuc3BlZWNoU3ludGhlc2lzO1xuXG5jb25zdCBzZWxlY3RWb2ljZSA9IHJlcXVpcmVCeUlkKFwic2VsZWN0LXZvaWNlXCIpXG5cbmxldCB2b2ljZXM7XG5cbmZ1bmN0aW9uIHJlbW92ZVZvaWNlT3B0aW9ucygpIHtcbiAgZm9yIChjb25zdCBjaGlsZCBvZiBzZWxlY3RWb2ljZS5jaGlsZHJlbikge1xuICAgIGNoaWxkLnJlbW92ZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGxvYWRWb2ljZXMoKSB7XG4gIHZvaWNlcyA9IHN5bnRoLmdldFZvaWNlcygpO1xuICByZW1vdmVWb2ljZU9wdGlvbnMoKTtcbiAgbGV0IGNob3NlblZvaWNlSW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHZvaWNlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmICghL15wdC0vLnRlc3Qodm9pY2VzW2ldLmxhbmcpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24udGV4dENvbnRlbnQgPSBgJHt2b2ljZXNbaV0ubmFtZX0gKCR7dm9pY2VzW2ldLmxhbmd9KWA7XG4gICAgb3B0aW9uLnZhbHVlID0gaTtcbiAgICBzZWxlY3RWb2ljZS5hcHBlbmRDaGlsZChvcHRpb24pO1xuICAgIGlmICh2b2ljZXNbaV0ubGFuZyA9PT0gJ3B0LUJSJyAmJiB2b2ljZXNbaV0ubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdnb29nbGUnKSkge1xuICAgICAgY2hvc2VuVm9pY2VJbmRleCA9IGk7XG4gICAgfVxuICB9XG4gIHNlbGVjdFZvaWNlLnZhbHVlID0gY2hvc2VuVm9pY2VJbmRleDtcbn1cblxuLy8gaW4gR29vZ2xlIENocm9tZSB0aGUgdm9pY2VzIGFyZSBub3QgcmVhZHkgb24gcGFnZSBsb2FkXG5pZiAoXCJvbnZvaWNlc2NoYW5nZWRcIiBpbiBzeW50aCkge1xuICBzeW50aC5vbnZvaWNlc2NoYW5nZWQgPSBsb2FkVm9pY2VzO1xufSBlbHNlIHtcbiAgbG9hZFZvaWNlcygpO1xufVxuXG5leHBvcnQgY29uc3Qgc3BlYWsgPSAodGV4dCkgPT4ge1xuICBjb25zdCBmaWx0ZXJlZCA9IHRleHQucmVwbGFjZSgvXFwqXFwqL2csICcnKTtcbiAgY29uc3QgdXR0ZXJhbmNlID0gbmV3IFNwZWVjaFN5bnRoZXNpc1V0dGVyYW5jZShmaWx0ZXJlZCk7XG4gIHV0dGVyYW5jZS52b2ljZSA9IHZvaWNlc1tzZWxlY3RWb2ljZS52YWx1ZV07XG4gIHN5bnRoLnNwZWFrKHV0dGVyYW5jZSk7XG59XG4iLCJcbmV4cG9ydCBjbGFzcyBCYXNlU3RvcmUge1xuICBnZXQga2V5KCkge30gLy8gYWJzdHJhY3RcblxuICBjbGVhclN0b3JlID0gKCkgPT4ge1xuICAgIHRoaXMuX3ZhbGlkYXRlKCk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5rZXkpO1xuICB9XG5cbiAgZ2V0U3RvcmUgPSAoKSA9PiB7XG4gICAgdGhpcy5fdmFsaWRhdGUoKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaXRlbVJhdyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMua2V5KTtcbiAgICAgIGlmICghaXRlbVJhdykgcmV0dXJuIG51bGw7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShpdGVtUmF3KVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS53YXJuKGVycik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBzZXRTdG9yZSA9ICh2YWx1ZSkgPT4ge1xuICAgIHRoaXMuX3ZhbGlkYXRlKCk7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMua2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oZXJyKTtcbiAgICB9XG4gIH1cblxuICBfdmFsaWRhdGUgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmtleSkgdGhyb3cgbmV3IEVycm9yKCdsb2NhbCBzdG9yYWdlIGtleSBpcyByZXF1aXJlZCcpO1xuICB9XG59IiwiaW1wb3J0IHsgQmFzZVN0b3JlIH0gZnJvbSBcIi4vQmFzZVN0b3JlXCI7XG5pbXBvcnQgeyBFWEVSQ0lTRSwgT1JERVIgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbmNsYXNzIE9wdGlvbnNTdG9yZSBleHRlbmRzIEJhc2VTdG9yZSB7XG4gIGdldCBrZXkoKSB7XG4gICAgcmV0dXJuIFwib3B0aW9ucy1kYXRhXCJcbiAgfVxuXG4gIF9kZWZhdWx0VmFsdWUgPSB7XG4gICAgb3JkZXI6IE9SREVSLkFOWSxcbiAgICBzZWxlY3RlZEV4ZXJjaXNlczoge1xuICAgICAgW0VYRVJDSVNFLlZFUl9DT05KQVRJT05dOiB0cnVlLFxuICAgICAgW0VYRVJDSVNFLlZJUl9DT05KVUdBVElPTl06IHRydWUsXG4gICAgICBbRVhFUkNJU0UuV0VBS19QSFJBU0VTXTogdHJ1ZSxcbiAgICB9LFxuICB9O1xuXG4gIF9zdGF0ZSA9IHRoaXMuZ2V0U3RvcmUoKSB8fCB7IC4uLnRoaXMuX2RlZmF1bHRWYWx1ZSB9O1xuXG4gIC8qKlxuICAgKiBAcmV0dXJucyBzdHJpbmdcbiAgICovXG4gIGdldE9yZGVyID0gKCkgPT4gdGhpcy5fc3RhdGUub3JkZXI7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB2YWxcbiAgICovXG4gIHNldE9yZGVyID0gKHZhbCkgPT4ge1xuICAgIHRoaXMuX3N0YXRlLm9yZGVyID0gdmFsO1xuICAgIHRoaXMuc2V0U3RvcmUodGhpcy5fc3RhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm5zIG9iamVjdFxuICAgKi9cbiAgZ2V0U2VsZWN0ZWRFeGVyY2lzZXMgPSAoKSA9PiB0aGlzLl9zdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlcztcblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGV4ZXJjaXNlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZWxlY3RlZFxuICAgKi9cbiAgc2V0U2VsZWN0ZWRFeGVyY2lzZSA9IChleGVyY2lzZSwgaXNTZWxlY3RlZCkgPT4ge1xuICAgIHRoaXMuX3N0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW2V4ZXJjaXNlXSA9IGlzU2VsZWN0ZWQ7XG4gICAgdGhpcy5zZXRTdG9yZSh0aGlzLl9zdGF0ZSk7XG4gIH1cblxuICByZXNldCA9ICgpID0+IHtcbiAgICB0aGlzLmNsZWFyU3RvcmUoKTtcbiAgICB0aGlzLl9zdGF0ZSA9IHsgLi4udGhpcy5fZGVmYXVsdFZhbHVlIH07XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IG9wdGlvbnNTdG9yZSA9IG5ldyBPcHRpb25zU3RvcmUoKTtcbiIsIlxuZXhwb3J0IGZ1bmN0aW9uIHNodWZmbGVBcnJheShhcnJheSkge1xuICBjb25zdCBjb3B5ID0gYXJyYXkuc2xpY2UoKVxuICBmb3IgKGxldCBpID0gY29weS5sZW5ndGggLSAxOyBpID4gMDsgaS0tKSB7XG4gICAgY29uc3QgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpO1xuICAgIGNvbnN0IHRlbXAgPSBjb3B5W2ldO1xuICAgIGNvcHlbaV0gPSBjb3B5W2pdO1xuICAgIGNvcHlbal0gPSB0ZW1wO1xuICB9XG4gIHJldHVybiBjb3B5O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgb3B0VGV4dCkge1xuICBjb25zdCByZXN1bHQgPSB0eXBlb2YgY29uZGl0aW9uID09PSAnZnVuY3Rpb24nID8gY29uZGl0aW9uKCkgOiBjb25kaXRpb25cbiAgaWYgKCFyZXN1bHQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3Iob3B0VGV4dCB8fCAnQXNzZXJ0aW9uIEZhaWxlZCEnKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVxdWlyZUJ5SWQoaWQpIHtcbiAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgaWYgKCFlbGVtKSB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIERPTSBlbGVtZW50IHdpdGggaWQgXCIke2lkfVwiISFgKTtcbiAgcmV0dXJuIGVsZW07XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCBjb25qIGZyb20gJy4vcmVzb3VyY2VzL2Nvbmp1Z2F0aW9uLXZlci12aXIueWFtbCc7XG5pbXBvcnQgd2Vha1BocmFzZXMgZnJvbSAnLi9yZXNvdXJjZXMvd2Vhay1waHJhc2VzLnlhbWwnO1xuXG5pbXBvcnQgeyBFWEVSQ0lTRSwgT1JERVIgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBpc0NoYXJQcmVzc2VkLCBTcGVjaWFsS2V5IH0gZnJvbSAnLi9rZXlib2FyZFV0aWxzJztcbmltcG9ydCB7IHNwZWFrIH0gZnJvbSAnLi9zcGVhaydcbmltcG9ydCB7IG9wdGlvbnNTdG9yZSB9IGZyb20gJy4vc3RvcmVzL09wdGlvbnNTdG9yZSc7XG5pbXBvcnQgeyBzaHVmZmxlQXJyYXksIGFzc2VydCwgcmVxdWlyZUJ5SWQgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgY2FyZFF1ZXN0aW9uID0gcmVxdWlyZUJ5SWQoJ2NhcmQtcXVlc3Rpb24nKTtcbmNvbnN0IGNhcmRBbnN3ZXIgPSByZXF1aXJlQnlJZCgnY2FyZC1hbnN3ZXInKTtcbmNvbnN0IGNhcmRRdWVzdGlvbkNvbnRlbnQgPSBjYXJkUXVlc3Rpb24uY2hpbGRyZW5bMF1cbmNvbnN0IGNhcmRBbnN3ZXJDb250ZW50ID0gY2FyZEFuc3dlci5jaGlsZHJlblswXVxuXG5hc3NlcnQoY2FyZFF1ZXN0aW9uQ29udGVudCwgJ2NhcmRRdWVzdGlvbkNvbnRlbnQgZG9lcyBub3QgZXhpc3QnKTtcbmFzc2VydChjYXJkQW5zd2VyQ29udGVudCwgJ2NhcmRBbnN3ZXJDb250ZW50IGRvZXMgbm90IGV4aXN0Jyk7XG5cbmNvbnN0IGJ1dHRvblByZXYgPSByZXF1aXJlQnlJZCgnYnV0dG9uLXByZXYnKTtcbmNvbnN0IGJ1dHRvbk5leHQgPSByZXF1aXJlQnlJZCgnYnV0dG9uLW5leHQnKTtcbmNvbnN0IGJ1dHRvblJlc2h1ZmZsZSA9IHJlcXVpcmVCeUlkKCdidXR0b24tcmVzaHVmZmxlJyk7XG5jb25zdCBidXR0b25TcGVhayA9IHJlcXVpcmVCeUlkKCdidXR0b24tc3BlYWsnKTtcbmNvbnN0IHByb2dyZXNzID0gcmVxdWlyZUJ5SWQoJ3Byb2dyZXNzJyk7XG5jb25zdCBmb3JtUXVlc3Rpb25PcmRlciA9IHJlcXVpcmVCeUlkKCdmb3JtLXF1ZXN0aW9uLW9yZGVyJyk7XG5jb25zdCBmb3JtU2VsZWN0RXhlcmNpc2VzID0gcmVxdWlyZUJ5SWQoJ2Zvcm0tc2VsZWN0LWV4ZXJjaXNlcycpO1xuXG5jb25zdCBzdGF0ZSA9IHtcbiAgcmV2ZWFsZWQ6IGZhbHNlLFxuICBwcm9ibGVtczogW10sIC8vIGFycmF5IG9mIHR1cGxlcyAtPiBbcXVlc3Rpb24sIGFuc3dlciwgcG9ydHVndWVzZS1pbmRleC1mb3ItdGV4dC10by1zcGVlY2hdW11cbiAgaW5kZXg6IDAsXG4gIG9yZGVyOiBvcHRpb25zU3RvcmUuZ2V0T3JkZXIoKSxcbiAgc2VsZWN0ZWRFeGVyY2lzZXM6IG9wdGlvbnNTdG9yZS5nZXRTZWxlY3RlZEV4ZXJjaXNlcygpLFxufTtcblxuZnVuY3Rpb24gbWFpbigpIHtcbiAgcmVuZGVyT3B0aW9ucygpO1xuICBzaHVmZmxlUXVlc3Rpb25zKCk7XG4gIHNldHVwTGlzdGVuZXJzKCk7XG59XG5cbmZ1bmN0aW9uIHJhbmRCb29sKCkge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKSA+PSAwLjVcbn1cblxuZnVuY3Rpb24gc2h1ZmZsZVF1ZXN0aW9ucygpIHtcbiAgc3RhdGUucmV2ZWFsZWQgPSBmYWxzZTtcbiAgc3RhdGUucHJvYmxlbXMgPSBbXTtcbiAgc3RhdGUuaW5kZXggPSAwO1xuICBjb25zdCBwcm9ibGVtcyA9IFtdXG4gIGNvbnN0IGFkZFByb2JsZW0gPSAocHJvYmxlbSkgPT4ge1xuICAgIGlmICghcHJvYmxlbS5lbiB8fCAhcHJvYmxlbS5wcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBQcm9ibGVtIGlzIGludmFsaWQ6ICR7SlNPTi5zdHJpbmdpZnkocHJvYmxlbSl9YClcbiAgICB9XG4gICAgaWYgKHN0YXRlLm9yZGVyID09PSBPUkRFUi5FTl9GSVJTVCkge1xuICAgICAgcHJvYmxlbXMucHVzaChbcHJvYmxlbS5lbiwgcHJvYmxlbS5wciwgMV0pO1xuICAgIH0gZWxzZSBpZiAoc3RhdGUub3JkZXIgPT09IE9SREVSLlBSX0ZJUlNUKSB7XG4gICAgICBwcm9ibGVtcy5wdXNoKFtwcm9ibGVtLnByLCBwcm9ibGVtLmVuLCAwXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZsaXAgPSByYW5kQm9vbCgpO1xuICAgICAgaWYgKGZsaXApIHtcbiAgICAgICAgcHJvYmxlbXMucHVzaChbcHJvYmxlbS5lbiwgcHJvYmxlbS5wciwgMV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvYmxlbXMucHVzaChbcHJvYmxlbS5wciwgcHJvYmxlbS5lbiwgMF0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlc1tFWEVSQ0lTRS5WRVJfQ09OSkFUSU9OXSkge1xuICAgIGNvbmoudmVyLnByZXNlbnQuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZlci5wcmV0ZXJpdGUuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZlci5pbXBlcmZlY3QuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZlci5wcmVzZW50UGVyZmVjdC5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICAgIGNvbmoudmVyLmZ1dHVyZS5mb3JFYWNoKGFkZFByb2JsZW0pO1xuICB9XG5cbiAgaWYgKHN0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW0VYRVJDSVNFLlZJUl9DT05KVUdBVElPTl0pIHtcbiAgICBjb25qLnZpci5wcmVzZW50LmZvckVhY2goYWRkUHJvYmxlbSk7XG4gICAgY29uai52aXIucHJldGVyaXRlLmZvckVhY2goYWRkUHJvYmxlbSk7XG4gICAgY29uai52aXIuaW1wZXJmZWN0LmZvckVhY2goYWRkUHJvYmxlbSk7XG4gICAgY29uai52aXIucHJlc2VudFBlcmZlY3QuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgICBjb25qLnZpci5mdXR1cmUuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgfVxuXG4gIGlmIChzdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlc1tFWEVSQ0lTRS5XRUFLX1BIUkFTRVNdKSB7XG4gICAgd2Vha1BocmFzZXMuZm9yRWFjaChhZGRQcm9ibGVtKTtcbiAgfVxuXG4gIHN0YXRlLnByb2JsZW1zID0gc2h1ZmZsZUFycmF5KHByb2JsZW1zKTtcblxuICByZW5kZXJDb250ZW50KCk7XG59XG5cbmZ1bmN0aW9uIHBsYXlUcmFuc2xhdGlvbkF1ZGlvKCkge1xuICBjb25zdCBudW1Qcm9ibGVtcyA9IHN0YXRlLnByb2JsZW1zLmxlbmd0aFxuXG4gIGlmIChudW1Qcm9ibGVtcyA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGN1cnJlbnRJbmRleCA9IHN0YXRlLmluZGV4ICUgbnVtUHJvYmxlbXM7XG4gIGNvbnN0IGN1cnJlbnRQcm9ibGVtID0gc3RhdGUucHJvYmxlbXNbY3VycmVudEluZGV4XTtcbiAgc3BlYWsoY3VycmVudFByb2JsZW1bY3VycmVudFByb2JsZW1bMl1dKVxufVxuXG5mdW5jdGlvbiBhZHZhbmNlKCkge1xuICBpZiAoc3RhdGUucmV2ZWFsZWQpIHtcbiAgICBzdGF0ZS5pbmRleCsrO1xuICAgIHN0YXRlLnJldmVhbGVkID0gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgc3RhdGUucmV2ZWFsZWQgPSB0cnVlO1xuICB9XG4gIHJlbmRlckNvbnRlbnQoKTtcbn1cblxuZnVuY3Rpb24gcmV3aW5kKCkge1xuICBzdGF0ZS5yZXZlYWxlZCA9IGZhbHNlO1xuICBzdGF0ZS5pbmRleC0tO1xuICBpZiAoc3RhdGUuaW5kZXggPCAwKSBzdGF0ZS5pbmRleCA9IHN0YXRlLnByb2JsZW1zLmxlbmd0aCAtIDE7XG4gIHJlbmRlckNvbnRlbnQoKTtcbn1cblxuZnVuY3Rpb24gc2V0dXBMaXN0ZW5lcnMoKSB7XG4gIGJ1dHRvbk5leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhZHZhbmNlKTtcbiAgYnV0dG9uUHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJld2luZCk7XG4gIGJ1dHRvblJlc2h1ZmZsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNodWZmbGVRdWVzdGlvbnMpO1xuICBidXR0b25TcGVhay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlUcmFuc2xhdGlvbkF1ZGlvKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleVByZXNzKTtcbiAgZm9ybVF1ZXN0aW9uT3JkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlUXVlc3Rpb25PcmRlckNoYW5nZSlcbiAgZm9ybVNlbGVjdEV4ZXJjaXNlcy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVTZWxlY3RFeGVyY2lzZUNoZWNrKVxufVxuXG4vKipcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqL1xuZnVuY3Rpb24gaGFuZGxlS2V5UHJlc3MoZXYpIHtcbiAgaWYgKCFldikgcmV0dXJuO1xuXG4gIGlmIChpc0NoYXJQcmVzc2VkKGV2LCBTcGVjaWFsS2V5LkFycm93UmlnaHQpKSB7XG4gICAgYWR2YW5jZSgpO1xuICB9IGVsc2UgaWYgKGlzQ2hhclByZXNzZWQoZXYsIFNwZWNpYWxLZXkuQXJyb3dMZWZ0KSkge1xuICAgIHJld2luZCgpO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldlxuICovXG5mdW5jdGlvbiBoYW5kbGVRdWVzdGlvbk9yZGVyQ2hhbmdlKGV2KSB7XG4gIHN0YXRlLm9yZGVyID0gZXYudGFyZ2V0LnZhbHVlO1xuICBvcHRpb25zU3RvcmUuc2V0T3JkZXIoZXYudGFyZ2V0LnZhbHVlKTtcbiAgc2h1ZmZsZVF1ZXN0aW9ucygpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZcbiAqL1xuZnVuY3Rpb24gaGFuZGxlU2VsZWN0RXhlcmNpc2VDaGVjayhldikge1xuICBzdGF0ZS5zZWxlY3RlZEV4ZXJjaXNlc1tldi50YXJnZXQubmFtZV0gPSBldi50YXJnZXQuY2hlY2tlZDtcbiAgb3B0aW9uc1N0b3JlLnNldFNlbGVjdGVkRXhlcmNpc2UoZXYudGFyZ2V0Lm5hbWUsIGV2LnRhcmdldC5jaGVja2VkKTtcbiAgc2h1ZmZsZVF1ZXN0aW9ucygpO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDb250ZW50KCkge1xuICBjb25zdCBudW1Qcm9ibGVtcyA9IHN0YXRlLnByb2JsZW1zLmxlbmd0aFxuXG4gIGlmIChudW1Qcm9ibGVtcyA9PT0gMCkge1xuICAgIGNhcmRRdWVzdGlvbkNvbnRlbnQuaW5uZXJIVE1MID0gXCJQbGVhc2Ugc2VsZWN0IGFuIGV4ZXJjaXNlIHRvIGJlZ2luXCI7XG4gICAgY2FyZEFuc3dlckNvbnRlbnQuaW5uZXJIVE1MID0gXCJQb3IgZmF2b3Igc2VsZWNpb25lIHVtIGV4ZXJjw61jaW8gcGFyYSBjb21lw6dhclwiO1xuICAgIGNhcmRBbnN3ZXIuY2xhc3NMaXN0LmFkZCgncmV2ZWFsZWQnKTtcbiAgICBwcm9ncmVzcy5pbm5lckhUTUwgPSBcIjAgLyAwXCI7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY3VycmVudEluZGV4ID0gc3RhdGUuaW5kZXggJSBudW1Qcm9ibGVtcztcbiAgY29uc3QgcHJvZ3Jlc3NUZXh0ID0gYCR7Y3VycmVudEluZGV4ICsgMX0gLyAke251bVByb2JsZW1zfWBcbiAgY29uc3QgY3VycmVudFByb2JsZW0gPSBzdGF0ZS5wcm9ibGVtc1tjdXJyZW50SW5kZXhdO1xuXG4gIGFzc2VydChjdXJyZW50UHJvYmxlbSwgYGN1cnJlbnRQcm9ibGVtIG91dCBvZiBib3VuZHMgLSB0cmllZCBpbmRleCAke2N1cnJlbnRJbmRleH0gZm9yIGFycmF5IG9mIGxlbmd0aCAke251bVByb2JsZW1zfWApO1xuXG4gIGNhcmRRdWVzdGlvbkNvbnRlbnQuaW5uZXJIVE1MID0gbWFya2lmeVRleHQoY3VycmVudFByb2JsZW1bMF0pO1xuICBjYXJkQW5zd2VyQ29udGVudC5pbm5lckhUTUwgPSBtYXJraWZ5VGV4dChjdXJyZW50UHJvYmxlbVsxXSk7XG5cbiAgaWYgKHN0YXRlLnJldmVhbGVkKSB7XG4gICAgY2FyZEFuc3dlci5jbGFzc0xpc3QuYWRkKCdyZXZlYWxlZCcpO1xuICB9IGVsc2Uge1xuICAgIGNhcmRBbnN3ZXIuY2xhc3NMaXN0LnJlbW92ZSgncmV2ZWFsZWQnKTtcbiAgfVxuXG4gIHByb2dyZXNzLmlubmVySFRNTCA9IHByb2dyZXNzVGV4dDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyT3B0aW9ucygpIHtcbiAgZm9ybVF1ZXN0aW9uT3JkZXIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICBpZiAoaW5wdXQubmFtZSA9PT0gJ3F1ZXN0aW9uLW9yZGVyJykge1xuICAgICAgaW5wdXQuY2hlY2tlZCA9IHN0YXRlLm9yZGVyID09PSBpbnB1dC52YWx1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIGZvcm1TZWxlY3RFeGVyY2lzZXMucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICBpZiAoaW5wdXQubmFtZS5pbmNsdWRlcygnY2hlY2tib3gtZXhlcmNpc2UnKSkge1xuICAgICAgaW5wdXQuY2hlY2tlZCA9IHN0YXRlLnNlbGVjdGVkRXhlcmNpc2VzW2lucHV0Lm5hbWVdO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHRleHRcbiAqIEByZXR1cm5zIHN0cmluZ1xuICovXG5mdW5jdGlvbiBtYXJraWZ5VGV4dCh0ZXh0KSB7XG4gIGNvbnN0IHJlZ01hcmtkb3duQm9sZFN0YXJ0ID0gLyg/PCFcXFMpXFwqXFwqKD8hXFxzKS9nO1xuICBjb25zdCByZWdNYXJrZG93bkJvbGRFbmQgPSAvKD88IVxccylcXCpcXCooPyFcXFMpL2c7XG4gIHJldHVybiB0ZXh0XG4gICAgLnJlcGxhY2UocmVnTWFya2Rvd25Cb2xkU3RhcnQsIFwiPHN0cm9uZyBjbGFzcz1cXFwiYWNjZW50XFxcIj5cIilcbiAgICAucmVwbGFjZShyZWdNYXJrZG93bkJvbGRFbmQsIFwiPC9zdHJvbmc+XCIpXG59XG5cbm1haW4oKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==